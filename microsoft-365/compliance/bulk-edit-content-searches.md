---
title: 批量编辑内容搜索
f1.keywords:
- NOCSH
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: 12/29/2016
audience: Admin
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MOE150
- MET150
ms.assetid: 39e4654a-9588-41f6-892b-c33ab57bfbe2
ms.custom:
- seo-marvel-apr2020
description: 使用安全与合规中心中的批量搜索编辑器快速更改一个或多个内容搜索的查询和内容位置。
ms.openlocfilehash: be7e37ec22966e16dfa3c6d1f37a34e6441e632a
ms.sourcegitcommit: 5db5047c24b56f3af90c2bc5c830a7a13eeeccad
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/09/2021
ms.locfileid: "53341028"
---
# <a name="bulk-edit-content-searches"></a><span data-ttu-id="08439-103">批量编辑内容搜索</span><span class="sxs-lookup"><span data-stu-id="08439-103">Bulk edit Content Searches</span></span>

<span data-ttu-id="08439-104">您可以使用内容搜索工具中的批量搜索编辑器同时编辑多个搜索。</span><span class="sxs-lookup"><span data-stu-id="08439-104">You can use the Bulk Search Editor in the Content Search tool to edit multiple searches at the same time.</span></span> <span data-ttu-id="08439-105">使用此工具可以快速更改一个或多个搜索的查询和内容位置。</span><span class="sxs-lookup"><span data-stu-id="08439-105">Using this tool lets you quickly change the query and content locations for one or more searches.</span></span> <span data-ttu-id="08439-106">然后，您可以重新运行搜索，并获取修订后的搜索的新估计搜索结果。</span><span class="sxs-lookup"><span data-stu-id="08439-106">Then you can rerun the searches and get new estimated search results for the revised searches.</span></span> <span data-ttu-id="08439-107">编辑器还允许您复制和粘贴查询和内容位置，Microsoft Excel文件或文本文件。</span><span class="sxs-lookup"><span data-stu-id="08439-107">The editor also lets you copy and paste queries and content locations from a Microsoft Excel file or text file.</span></span> <span data-ttu-id="08439-108">这意味着您可以使用搜索统计信息工具查看一个或多个搜索的统计信息，将统计信息导出到 CSV 文件，您可以在其中编辑查询和内容Excel。</span><span class="sxs-lookup"><span data-stu-id="08439-108">This means you can use the Search Statistics tool to view the statistics of one or more searches, export the statistics to a CSV file, where you can edit the queries and content locations in Excel.</span></span> <span data-ttu-id="08439-109">然后，使用批量搜索编辑器将修改后的查询和内容位置添加到搜索。</span><span class="sxs-lookup"><span data-stu-id="08439-109">Then you use the Bulk Search Editor to add the revised queries and content locations to the searches.</span></span> <span data-ttu-id="08439-110">修改一个或多个搜索后，可以重新启动它们并获取新的估计搜索结果。</span><span class="sxs-lookup"><span data-stu-id="08439-110">After you've revised one or more searches, you can restart them and get new estimated search results.</span></span>

<span data-ttu-id="08439-111">有关使用搜索统计信息工具的信息，请参阅 [查看内容搜索结果的关键字统计信息](view-keyword-statistics-for-content-search.md)。</span><span class="sxs-lookup"><span data-stu-id="08439-111">For more information about using the Search Statistics tool, see [View keyword statistics for Content Search results](view-keyword-statistics-for-content-search.md).</span></span>

## <a name="use-the-bulk-search-editor-to-change-queries"></a><span data-ttu-id="08439-112">使用批量搜索编辑器更改查询</span><span class="sxs-lookup"><span data-stu-id="08439-112">Use the Bulk Search Editor to change queries</span></span>

1. <span data-ttu-id="08439-113">转到 <https://compliance.microsoft.com> ，然后选择"内容 **搜索"。**</span><span class="sxs-lookup"><span data-stu-id="08439-113">Go to <https://compliance.microsoft.com>, and then select **Content search**.</span></span>

2. <span data-ttu-id="08439-114">在搜索列表中，选择一个或多个搜索，然后选择批量 **搜索编辑器** ![ 批量搜索编辑器按钮 ](../media/1ddb3d18-2f00-4a7b-98a6-817ca5ec7014.png) 。</span><span class="sxs-lookup"><span data-stu-id="08439-114">In the list of searches, select one or more searches, and then select **Bulk Search Editor** ![Bulk Search Editor button](../media/1ddb3d18-2f00-4a7b-98a6-817ca5ec7014.png).</span></span>

    ![选择一个或多个搜索，然后选择批量搜索编辑器](../media/600c9716-89a2-4451-b111-fa7cfaad2006.png)

    <span data-ttu-id="08439-116">以下信息显示在批量搜索编辑器 **的"** 查询"页上。</span><span class="sxs-lookup"><span data-stu-id="08439-116">The following information is displayed on the **Queries** page of the Bulk Search Editor.</span></span>

    !["批量搜索编辑器"页显示所选搜索的查询](../media/189659af-cc78-4479-b0bc-a93decad2f6c.png)

    <span data-ttu-id="08439-118">a.</span><span class="sxs-lookup"><span data-stu-id="08439-118">a.</span></span> <span data-ttu-id="08439-119">" **搜索** "列显示内容搜索的名称。</span><span class="sxs-lookup"><span data-stu-id="08439-119">The **Search** column displays the name of the Content Search.</span></span> <span data-ttu-id="08439-120">如前所述，您可以编辑多个搜索的查询。</span><span class="sxs-lookup"><span data-stu-id="08439-120">As previously stated, you can edit the query for multiple searches.</span></span>

    <span data-ttu-id="08439-121">b.</span><span class="sxs-lookup"><span data-stu-id="08439-121">b.</span></span> <span data-ttu-id="08439-122">" **查询** "列显示"搜索"列中列出的内容搜索 **的** 查询。</span><span class="sxs-lookup"><span data-stu-id="08439-122">The **Query** column displays the query for the Content Search listed in the **Search** column.</span></span> <span data-ttu-id="08439-123">如果查询是使用关键字列表功能创建的，则关键字用文本 分隔 **`(c:s)`** 。</span><span class="sxs-lookup"><span data-stu-id="08439-123">If the query was created using the keyword list feature, the keywords are separated by the text **`(c:s)`**.</span></span> <span data-ttu-id="08439-124">这表示关键字由 **OR** 运算符连接。</span><span class="sxs-lookup"><span data-stu-id="08439-124">This indicates that the keywords are connected by the **OR** operator.</span></span> <span data-ttu-id="08439-125">此外，如果查询包含条件，则关键字和条件用文本 分隔 **`(c:c)`** 。</span><span class="sxs-lookup"><span data-stu-id="08439-125">Additionally, if the query includes conditions, the keywords and the conditions are separated by the text **`(c:c)`**.</span></span> <span data-ttu-id="08439-126">这表示关键字 (或关键字阶段) **AND** 运算符连接到条件。</span><span class="sxs-lookup"><span data-stu-id="08439-126">This indicates that the keywords (or keyword phases) are connected to the conditions by the **AND** operator.</span></span> <span data-ttu-id="08439-127">例如，在上一张屏幕截图中，搜索 ContosoSearch1 的 等效 KQL 查询 `customer (c:s) pricing(c:c)(date=2000-01-01..2016-09-30)` 为  `(customer OR pricing) AND (date=2002-01-01..2016-09-30)` 。</span><span class="sxs-lookup"><span data-stu-id="08439-127">For example, in the previous screenshot the for search ContosoSearch1, the KQL query that is equivalent to `customer (c:s) pricing(c:c)(date=2000-01-01..2016-09-30)` would be  `(customer OR pricing) AND (date=2002-01-01..2016-09-30)`.</span></span>

3. <span data-ttu-id="08439-128">若要编辑查询，请在要更改的查询单元格中选择并执行以下操作之一。</span><span class="sxs-lookup"><span data-stu-id="08439-128">To edit a query, select in the cell of the query that you want to change and doing one of the following things.</span></span> <span data-ttu-id="08439-129">选择单元格时，单元格边框为蓝色框。</span><span class="sxs-lookup"><span data-stu-id="08439-129">The cell is bordered by a blue box when you select it.</span></span>

   - <span data-ttu-id="08439-130">在单元格中键入新查询。</span><span class="sxs-lookup"><span data-stu-id="08439-130">Type the new query in the cell.</span></span> <span data-ttu-id="08439-131">无法编辑查询的一部分。</span><span class="sxs-lookup"><span data-stu-id="08439-131">You can't edit a portion of the query.</span></span> <span data-ttu-id="08439-132">您必须键入整个查询。</span><span class="sxs-lookup"><span data-stu-id="08439-132">You have to type the entire query.</span></span>

      <span data-ttu-id="08439-133">或</span><span class="sxs-lookup"><span data-stu-id="08439-133">Or</span></span>

   - <span data-ttu-id="08439-134">在单元格中粘贴新查询。</span><span class="sxs-lookup"><span data-stu-id="08439-134">Paste a new query in the cell.</span></span> <span data-ttu-id="08439-135">这假定你已复制文件（如文本文件或文件）中的Excel文本。</span><span class="sxs-lookup"><span data-stu-id="08439-135">This assumes that you've copied the query text from a file, such as a text file or an Excel file.</span></span>

4. <span data-ttu-id="08439-136">在"查询"页上编辑一个或多个查询后，选择"保存 **"。**</span><span class="sxs-lookup"><span data-stu-id="08439-136">After you've edited one or more queries on the **Queries** page, select **Save**.</span></span>

    <span data-ttu-id="08439-137">修订后的查询将显示在所选搜索的 **"** 查询"列中。</span><span class="sxs-lookup"><span data-stu-id="08439-137">The revised query is displayed in the **Query** column for the selected search.</span></span>

5. <span data-ttu-id="08439-138">选择 **"关闭** "以关闭批量搜索编辑器。</span><span class="sxs-lookup"><span data-stu-id="08439-138">Select **Close** to close the Bulk Search Editor.</span></span>

6. <span data-ttu-id="08439-139">在" **内容搜索** "页上，选择您编辑的搜索，然后选择"启动 **搜索"** 以使用修改后的查询重新启动搜索。</span><span class="sxs-lookup"><span data-stu-id="08439-139">On the **Content search** page, select the search that you edited, and select **Start** search to restart the search using the revised query.</span></span>

<span data-ttu-id="08439-140">以下是使用批量搜索编辑器编辑查询的一些提示：</span><span class="sxs-lookup"><span data-stu-id="08439-140">Here are some tips for editing queries using the Bulk Search Editor:</span></span>

- <span data-ttu-id="08439-141">使用 Ctrl **C** (将现有查询) 复制到文本文件。</span><span class="sxs-lookup"><span data-stu-id="08439-141">Copy the existing query (by using **Ctrl C**) to a text file.</span></span> <span data-ttu-id="08439-142">编辑文本文件中的查询，然后复制修改后的查询， (**Ctrl V**) 粘贴回"查询"页上 **的单元格中** 。</span><span class="sxs-lookup"><span data-stu-id="08439-142">Edit the query in the text file, and then copy the revised query and paste it (using **Ctrl V**) back into the cell on the **Queries** page.</span></span>

- <span data-ttu-id="08439-143">您还可以从其他应用程序（如 (或 Microsoft Word）复制Microsoft Excel) 。</span><span class="sxs-lookup"><span data-stu-id="08439-143">You can also copy queries from other applications (such as Microsoft Word or Microsoft Excel).</span></span> <span data-ttu-id="08439-144">但是，您可能会无意中使用批量搜索编辑器将不受支持的字符添加到查询中。</span><span class="sxs-lookup"><span data-stu-id="08439-144">However, you might inadvertently add unsupported characters to a query using the Bulk Search Editor.</span></span> <span data-ttu-id="08439-145">防止不受支持的字符的最好办法就是只需在"查询"页上的单元格 **中** 键入查询。</span><span class="sxs-lookup"><span data-stu-id="08439-145">The best way to prevent unsupported characters is to just type the query in a cell on the **Queries** page.</span></span> <span data-ttu-id="08439-146">也可以从 Word 或 Excel 复制查询，然后将其粘贴到纯文本编辑器（如 Microsoft 记事本）中。</span><span class="sxs-lookup"><span data-stu-id="08439-146">Or you can copy a query from Word or Excel and then paste it to file in a plain text editor, such as Microsoft Notepad.</span></span> <span data-ttu-id="08439-147">接下来，保存文本文件，并在" **编码**"下拉列表中选择" **ANSI**"。</span><span class="sxs-lookup"><span data-stu-id="08439-147">Then save the text file and select **ANSI** in the **Encoding** drop-down list.</span></span> <span data-ttu-id="08439-148">这将删除任何格式和不受支持的字符。</span><span class="sxs-lookup"><span data-stu-id="08439-148">This removes any formatting and unsupported characters.</span></span> <span data-ttu-id="08439-149">然后，您可以将查询从文本文件复制并粘贴到 **"查询"** 页。</span><span class="sxs-lookup"><span data-stu-id="08439-149">Then you can copy and paste the query from the text file to the **Queries** page.</span></span>

## <a name="use-the-bulk-search-editor-to-change-content-locations"></a><span data-ttu-id="08439-150">使用批量搜索编辑器更改内容位置</span><span class="sxs-lookup"><span data-stu-id="08439-150">Use the Bulk Search Editor to change content locations</span></span>

1. <span data-ttu-id="08439-151">在一个或多个选定搜索的批量搜索编辑器中，选择"**启用批量** 位置编辑器"，然后选择页面上显示的位置链接。</span><span class="sxs-lookup"><span data-stu-id="08439-151">In the Bulk Search Editor for one or more selected searches, select **Enable bulk location editor**, and then select the **Locations** link that is displayed on the page.</span></span>

    <span data-ttu-id="08439-152">以下信息显示在批量搜索 **编辑器的** "位置"页上。</span><span class="sxs-lookup"><span data-stu-id="08439-152">The following information is displayed on the **Locations** page of the Bulk Search Editor.</span></span>

    ![选择"启用批量位置编辑器"，然后选择"位置"以添加或删除内容位置](../media/a5a468ce-bd63-4c53-bc37-ff64cf769e59.png)

    <span data-ttu-id="08439-154">a.</span><span class="sxs-lookup"><span data-stu-id="08439-154">a.</span></span> <span data-ttu-id="08439-155">**要搜索的邮箱** 此部分显示每个选定内容搜索的列，以及搜索中包含的每个邮箱的一行。</span><span class="sxs-lookup"><span data-stu-id="08439-155">**Mailboxes to search** This section displays a column for each selected Content Search and a row for each mailbox that's included in the search.</span></span> <span data-ttu-id="08439-156">一个选中标记指示该邮箱包含在搜索中。</span><span class="sxs-lookup"><span data-stu-id="08439-156">A check mark indicates that the mailbox is included in the search.</span></span> <span data-ttu-id="08439-157">可以通过在空白行中键入邮箱的电子邮件地址，然后选中要添加到的内容搜索的复选框，将邮箱添加到搜索。</span><span class="sxs-lookup"><span data-stu-id="08439-157">You can add mailboxes to a search by typing the email address of the mailbox in a blank row and then selecting the check box for the Content Search that you want to add it to.</span></span> <span data-ttu-id="08439-158">或者，可以通过清除复选框从搜索中删除邮箱。</span><span class="sxs-lookup"><span data-stu-id="08439-158">Or you can remove a mailbox from a search by clearing the check box.</span></span>

    <span data-ttu-id="08439-159">b.</span><span class="sxs-lookup"><span data-stu-id="08439-159">b.</span></span> <span data-ttu-id="08439-160">**SharePoint搜索的网站** 此部分显示每个选定内容SharePoint OneDrive搜索中包含的每个网站和网站中的一行。</span><span class="sxs-lookup"><span data-stu-id="08439-160">**SharePoint sites to search** This section displays a row for each SharePoint and OneDrive site that's included in each selected Content Search.</span></span> <span data-ttu-id="08439-161">一个选中标记指示网站包含在搜索中。</span><span class="sxs-lookup"><span data-stu-id="08439-161">A check mark indicates that the site is included in the search.</span></span> <span data-ttu-id="08439-162">您可以通过在空白行中键入网站的 URL，然后选中要添加到的内容搜索的复选框，将网站添加到搜索。</span><span class="sxs-lookup"><span data-stu-id="08439-162">You can add sites to a search by typing the URL for the site in a blank row and then selecting the check box for the Content Search that you want to add it to.</span></span> <span data-ttu-id="08439-163">或者，可以通过清除此复选框从搜索中删除网站。</span><span class="sxs-lookup"><span data-stu-id="08439-163">Or you can remove a site from a search by clearing the check box.</span></span>

    <span data-ttu-id="08439-164">c.</span><span class="sxs-lookup"><span data-stu-id="08439-164">c.</span></span> <span data-ttu-id="08439-165">**其他搜索选项** 此部分指示搜索中是否包括未索引的项目和公用文件夹。</span><span class="sxs-lookup"><span data-stu-id="08439-165">**Other search options** This section indicates whether unindexed items and public folders are included in the search.</span></span> <span data-ttu-id="08439-166">若要包括它们，请确保选中了复选框。</span><span class="sxs-lookup"><span data-stu-id="08439-166">To include them, make sure the check box is selected.</span></span> <span data-ttu-id="08439-167">若要删除它们，请清除此复选框。</span><span class="sxs-lookup"><span data-stu-id="08439-167">To remove them, clear the check box.</span></span>

2. <span data-ttu-id="08439-168">编辑"位置"页面上的一个或多个节后，选择"保存 **"。**</span><span class="sxs-lookup"><span data-stu-id="08439-168">After you've edited one or more of the sections on the **Locations** page, select **Save**.</span></span>

    <span data-ttu-id="08439-169">修订的内容位置显示在所选搜索的适当部分中。</span><span class="sxs-lookup"><span data-stu-id="08439-169">The revised content locations are displayed in the appropriate section for the selected searches.</span></span>

3. <span data-ttu-id="08439-170">选择 **"关闭** "以关闭批量搜索编辑器。</span><span class="sxs-lookup"><span data-stu-id="08439-170">Select **Close** to close the Bulk Search Editor.</span></span>

4. <span data-ttu-id="08439-171">在" **内容搜索** "页上，选择您编辑的搜索，然后选择"启动 **搜索"** 以使用修改后的内容位置重新启动搜索。</span><span class="sxs-lookup"><span data-stu-id="08439-171">On the **Content search** page, select the search that you edited, and select **Start** search to restart the search using the revised content locations.</span></span>

<span data-ttu-id="08439-172">以下是使用批量搜索编辑器编辑内容位置的一些提示：</span><span class="sxs-lookup"><span data-stu-id="08439-172">Here are some tips for editing content locations using the Bulk Search Editor:</span></span>

- <span data-ttu-id="08439-173">您可以编辑内容搜索，以搜索组织的所有邮箱或网站，在"要搜索的邮箱"或"要搜索的SharePoint 网站"的空白行中键入"全部 **"，** 然后选中此复选框。</span><span class="sxs-lookup"><span data-stu-id="08439-173">You can edit Content Searches to search all mailboxes or sites in the organization by typing **All** in a blank row in the **Mailboxes to search** or **SharePoint sites to search** section and then selecting the check box.</span></span>

- <span data-ttu-id="08439-174">可以通过从文本文件或 Excel 文件复制多行，然后将这些行粘贴到"位置"页上的某一节中，向一个或多个搜索添加 **多个内容** 位置。</span><span class="sxs-lookup"><span data-stu-id="08439-174">You can add multiple content locations to one or more searches by copying multiple rows from a text file or an Excel file and then pasting them in a section on the **Locations** page.</span></span> <span data-ttu-id="08439-175">添加新位置后，请确保为要添加位置的每个搜索选中复选框。</span><span class="sxs-lookup"><span data-stu-id="08439-175">After you add new locations, be sure to select the check box for each search that you want add the location to.</span></span>

    > [!TIP]
    > <span data-ttu-id="08439-176">若要为组织中所有用户生成电子邮件地址列表，请运行步骤 [2：](search-the-mailbox-and-onedrive-for-business-for-a-list-of-users.md#step-2-generate-a-list-of-users)生成用户列表中的步骤 2 中的 PowerShell 命令。</span><span class="sxs-lookup"><span data-stu-id="08439-176">To generate a list of email addresses for all the users in your organization, run the PowerShell command in Step 2 in [Step 2: Generate a list of users](search-the-mailbox-and-onedrive-for-business-for-a-list-of-users.md#step-2-generate-a-list-of-users).</span></span> <span data-ttu-id="08439-177">或者按照获取组织中所有OneDrive [URL](/onedrive/list-onedrive-urls)列表中的步骤，生成组织中OneDrive for Business网站的列表。</span><span class="sxs-lookup"><span data-stu-id="08439-177">Or follow the steps in [Get a list of all user OneDrive URLs in your organization](/onedrive/list-onedrive-urls) to generate a list of all OneDrive for Business sites in your organization.</span></span> <span data-ttu-id="08439-178">请注意，您必须将组织的"MySite"域的 URL (例如，附加到脚本创建的 https://contoso-my.sharepoint.com) OneDrive for Business 网站。</span><span class="sxs-lookup"><span data-stu-id="08439-178">Note that you'll have to append the URL for your organization's MySite domain (for example, https://contoso-my.sharepoint.com) to the OneDrive for Business sites that's created by the script.</span></span> <span data-ttu-id="08439-179">获得电子邮件地址列表或网站OneDrive for Business后，可以在批量搜索编辑器中将它们复制并粘贴到"位置"页。 </span><span class="sxs-lookup"><span data-stu-id="08439-179">After you have list of email addresses or OneDrive for Business sites, you can copy and paste them to the **Locations** page in the Bulk Search Editor.</span></span>

- <span data-ttu-id="08439-180">选择" **保存"** 以在批量搜索编辑器中保存更改后，将验证添加到搜索的邮箱的电子邮件地址。</span><span class="sxs-lookup"><span data-stu-id="08439-180">After you select **Save** to save changes in Bulk Search Editor, the email address for mailboxes that you added to a search will be validated.</span></span> <span data-ttu-id="08439-181">如果电子邮件地址不存在，则会显示一条错误消息，指出无法找到该邮箱。</span><span class="sxs-lookup"><span data-stu-id="08439-181">If the email address doesn't exist, an error message is displayed saying the mailbox can't be located.</span></span> <span data-ttu-id="08439-182">不验证网站的 URL。</span><span class="sxs-lookup"><span data-stu-id="08439-182">URLs for sites aren't validated.</span></span>
