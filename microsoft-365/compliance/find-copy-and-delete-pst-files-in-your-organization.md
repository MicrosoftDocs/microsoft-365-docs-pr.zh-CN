---
title: 使用 PST 收集工具查找、复制和删除 PST 文件
f1.keywords:
- NOCSH
ms.author: markjjo
author: markjjo
manager: laurawi
audience: Admin
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
ms.collection: ''
search.appverid:
- MOE150
- MET150
ms.assetid: 7a150c84-049c-4a9c-8c91-22355b35f2a7
description: 使用 Microsoft PST 收集工具搜索组织的网络，以获取分散在整个组织中的 PST 文件的清单。
ms.custom: seo-marvel-apr2020
ms.openlocfilehash: 4f1ac7b0bfe30ec2d8a11b4882a29c064d22ef78
ms.sourcegitcommit: 973f5449784cb70ce5545bc3cf57bf1ce5209218
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/19/2020
ms.locfileid: "44817711"
---
# <a name="use-the-pst-collection-tool-to-find-copy-and-delete-pst-files-in-your-organization"></a><span data-ttu-id="cb71c-103">使用 PST 集合工具在您的组织中查找、复制和删除 PST 文件</span><span class="sxs-lookup"><span data-stu-id="cb71c-103">Use the PST Collection tool to find, copy, and delete PST files in your organization</span></span>

> [!IMPORTANT]
> <span data-ttu-id="cb71c-104">任何 Microsoft standard 支持计划或服务都不支持本文中介绍的 PST 集合工具。</span><span class="sxs-lookup"><span data-stu-id="cb71c-104">The PST Collection tool described in this article isn't supported under any Microsoft standard support program or service.</span></span> <span data-ttu-id="cb71c-105">该工具按原样提供，无任何种类的担保。</span><span class="sxs-lookup"><span data-stu-id="cb71c-105">The tool is provided AS IS without warranty of any kind.</span></span> <span data-ttu-id="cb71c-106">Microsoft 也不提供任何默示担保，包括但不仅限于对适销性或针对特定目的的适用性的默示担保。</span><span class="sxs-lookup"><span data-stu-id="cb71c-106">Microsoft further disclaims all implied warranties including, without limitation, any implied warranties of merchantability or of fitness for a particular purpose.</span></span> <span data-ttu-id="cb71c-107">由于工具的使用或性能的问题和文档将保留的全部风险。</span><span class="sxs-lookup"><span data-stu-id="cb71c-107">The entire risk arising out of the use or performance of the tool and documentation remains with you.</span></span> <span data-ttu-id="cb71c-108">在任何事件中，Microsoft、其作者除了因使用或无法使用工具或文档而导致的任何损坏（包括但不限于业务利润损失、业务中断、业务信息丢失或其他 pecuniary 丢失）之外，其他任何人（包括但不限于）因使用或无法使用工具或文档而导致的任何其他人都不承担责任，即使 Microsoft 已被告知可能存在此类损害。</span><span class="sxs-lookup"><span data-stu-id="cb71c-108">In no event shall Microsoft, its authors, or anyone else involved in the creation, production, or delivery of the tool be liable for any damages whatsoever (including, without limitation, damages for loss of business profits, business interruption, loss of business information, or other pecuniary loss) arising out of the use of or inability to use the tool or documentation, even if Microsoft has been advised of the possibility of such damages.</span></span>

<span data-ttu-id="cb71c-109">您可以使用 Microsoft PST 集合工具在您的组织的网络中搜索 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-109">You can use the Microsoft PST Collection tool to search your organization's network for PST files.</span></span> <span data-ttu-id="cb71c-110">该工具可帮助你获取分散在整个组织中的 PST 文件的清单。</span><span class="sxs-lookup"><span data-stu-id="cb71c-110">The tool helps you get an inventory of PST files that are scattered throughout your organization.</span></span> <span data-ttu-id="cb71c-111">查找 PST 文件后，可以使用 PST 集合工具将其复制到一个中心位置。</span><span class="sxs-lookup"><span data-stu-id="cb71c-111">After you find PST files, you can use the PST Collection tool to copy them in a central location.</span></span> <span data-ttu-id="cb71c-112">将 Pst 放在一个位置后，可以将其导入到 Exchange Online 邮箱（或单个 Exchange Online 邮箱）中，然后可以在 Office 365 中应用一组丰富的合规性功能。</span><span class="sxs-lookup"><span data-stu-id="cb71c-112">Having PSTs in a one place then allows you to import them to Exchange Online mailboxes (or a single Exchange Online mailbox), where you can then apply the rich set of compliance features in Office 365.</span></span> <span data-ttu-id="cb71c-113">这包括将 Pst 导入到用户的存档邮箱，使用电子数据展示搜索工具搜索您导入的 PST 文件中的特定邮件，使用电子数据展示保留和保留策略保留邮件，以及使用 Exchange Online 中的邮件记录管理功能管理这些邮件的生命周期。</span><span class="sxs-lookup"><span data-stu-id="cb71c-113">This includes importing PSTs to users' archive mailboxes, searching for specific messages in the PST files that you imported by using eDiscovery search tools, retaining messages by using eDiscovery holds and retention policies, and managing the life cycle of these messages using the messaging records management features in Exchange Online.</span></span> <span data-ttu-id="cb71c-114">确信您收集的 PST 文件已成功导入到 Office 365 后，您可以使用该工具将其从网络上的原始位置删除。</span><span class="sxs-lookup"><span data-stu-id="cb71c-114">After you're confident that the PST files that you collected have been successfully imported to Office 365, you can use the tool to delete them from their original location on your network.</span></span> 
  
<span data-ttu-id="cb71c-115">您可以使用 PST 集合工具执行的另一件事是，阻止用户创建新的 PST 文件，并更改您在网络上找到的现有 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-115">Another thing you can do with the PST Collection tool is prevent users from creating new PST files and changing the existing PST files that you find on your network.</span></span> <span data-ttu-id="cb71c-116">这些 "阻止" 功能可让你查找、收集和导入一组已知的 PST 文件到 Microsoft 365，并防止将来在组织中激增的 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-116">These "block" capabilities let you find, collect, and import a known set of PST files to Microsoft 365 and prevent the future proliferation of PST files in your organization.</span></span> 
  
## <a name="how-the-pst-collection-tool-works"></a><span data-ttu-id="cb71c-117">PST 集合工具的工作原理</span><span class="sxs-lookup"><span data-stu-id="cb71c-117">How the PST Collection tool works</span></span>

<span data-ttu-id="cb71c-118">以下是使用 PST 收集工具在组织中查找、控制、收集和删除 PST 文件的过程的快速概述。</span><span class="sxs-lookup"><span data-stu-id="cb71c-118">Here's a quick overview of the process of using the PST Collection tool to find, control, collect, and delete PST files in your organization.</span></span>
  
![PST 收集工具流程概述](../media/67a29f27-f83c-4f0a-9df4-7ed92d3086fe.png)
  
1. <span data-ttu-id="cb71c-120">**[步骤1：在您的网络上查找 pst 文件](#step-1-find-pst-files-on-your-network)**-当您运行该工具以查找 PST 文件时，请指定一个位置，如包含客户端和服务器计算机的 Active Directory 对象的组织单位。</span><span class="sxs-lookup"><span data-stu-id="cb71c-120">**[Step 1: Find PST files on your network](#step-1-find-pst-files-on-your-network)** - When you run the tool to find PST files, you specify a location, such as an organizational unit that contain Active Directory objects for client and server computers.</span></span> <span data-ttu-id="cb71c-121">您还可以搜索特定的计算机或网络文件共享。</span><span class="sxs-lookup"><span data-stu-id="cb71c-121">You can also search specific machines or network file shares.</span></span> <span data-ttu-id="cb71c-122">运行该工具时，会在目标计算机上安装 "轻型" 集合代理。</span><span class="sxs-lookup"><span data-stu-id="cb71c-122">When you run the tool, a "lightweight" Collection Agent is installed on the target computers.</span></span> <span data-ttu-id="cb71c-123">此代理在目标计算机上搜索 PST 文件，然后将信息返回到 PST 收集工具，以了解找到的任何 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-123">This agent searches the target computer for PST files and then sends information back to the PST Collection tool about any PST file it finds.</span></span> <span data-ttu-id="cb71c-124">该工具将创建日志文件，其中包含有关在指定位置找到的 PST 文件的信息。</span><span class="sxs-lookup"><span data-stu-id="cb71c-124">The tool creates log files that contains information about the PST files that were found in the specified locations.</span></span> <span data-ttu-id="cb71c-125">在后续步骤中运行此工具时，将使用这些文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-125">These files are used when you run the tool in later steps.</span></span> 
    
2. <span data-ttu-id="cb71c-126">**[（可选）步骤2：控制对 PST 文件的访问](#optional-step-2-control-access-to-pst-files)**-该工具将创建一个组策略对象（GPO），其中包含阻止用户创建或更改 PST 文件的设置。</span><span class="sxs-lookup"><span data-stu-id="cb71c-126">**[(Optional) Step 2: Control access to PST files](#optional-step-2-control-access-to-pst-files)** - The tool creates a Group Policy Object (GPO) with settings that prevent users from creating or changing PST files.</span></span> <span data-ttu-id="cb71c-127">此 GPO 将应用于您的域中的每个用户。</span><span class="sxs-lookup"><span data-stu-id="cb71c-127">This GPO is applied to every user in your domain.</span></span> <span data-ttu-id="cb71c-128">此可选步骤可帮助您 "锁定" 在第1步中找到的 PST 文件，以便您可以收集、导入和删除这些文件，而不会创建新的 PST 文件或更改现有的 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-128">This optional step helps you "lock down" the PST files that were found in Step 1, so that you can collect, import, and delete them without having new PST files created or the existing PST files changed.</span></span> 
    
3. <span data-ttu-id="cb71c-129">**[步骤3：将 pst 文件复制到收藏位置](#step-3-copy-the-pst-files-to-a-collection-location)**-这使您可以将 pst 文件收集到一个位置，以便您可以在步骤4中使用 Office 365 导入服务将其导入到 Exchange Online 邮箱中。</span><span class="sxs-lookup"><span data-stu-id="cb71c-129">**[Step 3: Copy the PST files to a collection location](#step-3-copy-the-pst-files-to-a-collection-location)** - This lets you collect the PST files in one location so that you can import them to Exchange Online mailboxes by using the Office 365 Import service in Step 4.</span></span> <span data-ttu-id="cb71c-130">当您在 "收集" 模式下运行该工具时，每个集合代理都会将 PST 文件从安装该代理的目标计算机复制到该集合的位置。</span><span class="sxs-lookup"><span data-stu-id="cb71c-130">When you run the tool in the "collect" mode, each Collection Agent copies the PST files from the target machine the agent is installed on to the collection location.</span></span> 
    
4. <span data-ttu-id="cb71c-131">**[步骤4：将 pst 文件导入到 Office 365](#step-4-import-the-pst-files-to-office-365)** -将 pst 文件复制到一个位置后，即可将其导入到 Exchange Online 邮箱。</span><span class="sxs-lookup"><span data-stu-id="cb71c-131">**[Step 4: Import the PST files to Office 365](#step-4-import-the-pst-files-to-office-365)** - After you've copied the PST files to one location, you're ready to import them to Exchange Online mailboxes.</span></span> 
    
5. <span data-ttu-id="cb71c-132">**[步骤5：删除在网络中找到的 pst 文件](#step-5-delete-the-pst-files-found-on-your-network)**-在 Office 365 中已将您找到和收集的 pst 文件导入到 Exchange Online 邮箱后，您可以使用 "pst 集合" 工具从第1步中找到的原始位置删除 pst 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-132">**[Step 5: Delete the PST files found on your network](#step-5-delete-the-pst-files-found-on-your-network)** - After the PST files that you found and collected have been imported to Exchange Online mailboxes in Office 365, you can use the PST Collection tool to delete the PST files from the original locations where they were found in Step 1.</span></span> 

## <a name="before-you-begin"></a><span data-ttu-id="cb71c-133">准备工作</span><span class="sxs-lookup"><span data-stu-id="cb71c-133">Before you begin</span></span>

- <span data-ttu-id="cb71c-134">按照以下步骤将 PST 集合工具下载到本地计算机。</span><span class="sxs-lookup"><span data-stu-id="cb71c-134">Follow these steps to download the PST Collection tool to your local computer.</span></span> 
    
    1. <span data-ttu-id="cb71c-135">[下载 "PST 集合" 工具](https://aka.ms/pstcollectiontool)。</span><span class="sxs-lookup"><span data-stu-id="cb71c-135">[Download the PST Collection tool](https://aka.ms/pstcollectiontool).</span></span>
    
    2. <span data-ttu-id="cb71c-136">在弹出窗口中，单击 "**另**存 \> **为**" 以将 PSTCollectionTool.zip 文件保存到本地计算机上的文件夹中。</span><span class="sxs-lookup"><span data-stu-id="cb71c-136">In the pop-up window, click **Save** \> **Save as** to save the PSTCollectionTool.zip file to a folder on your local computer.</span></span> 
    
    3. <span data-ttu-id="cb71c-137">将 PSTCollectionTool.zip 文件提取到本地计算机上的文件夹中;默认文件夹名称为 PSTCollectionTool。</span><span class="sxs-lookup"><span data-stu-id="cb71c-137">Extract the PSTCollectionTool.zip file to a folder on your local computer; the default folder name is PSTCollectionTool.</span></span>
    
- <span data-ttu-id="cb71c-138">若要在任何模式（查找、阻止、复制或删除）中运行 PST 集合工具，您必须是 Active Directory 域中的 Domain Administrators 组的成员。</span><span class="sxs-lookup"><span data-stu-id="cb71c-138">To run the PST Collection tool in any mode (Find, Block, Copy, or Delete), you have to be a member of the Domain Administrators group in your Active Directory domain.</span></span> 

## <a name="step-1-find-pst-files-on-your-network"></a><span data-ttu-id="cb71c-139">步骤1：在网络中查找 PST 文件</span><span class="sxs-lookup"><span data-stu-id="cb71c-139">Step 1: Find PST files on your network</span></span>

<span data-ttu-id="cb71c-140">第一步是运行 PST 集合工具以在您的组织中查找 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-140">The first step is to run the PST Collection tool to find PST files in your organization.</span></span> <span data-ttu-id="cb71c-141">您可以使用此工具搜索以下类型的位置。</span><span class="sxs-lookup"><span data-stu-id="cb71c-141">You can use the tool to search the following types of locations.</span></span> 
  
- <span data-ttu-id="cb71c-142">本地 Active Directory 域中的组织单位（Ou）。</span><span class="sxs-lookup"><span data-stu-id="cb71c-142">Organizational units (OUs) in an on-premises Active Directory domain.</span></span> <span data-ttu-id="cb71c-143">该工具将搜索指定 OU 中包含的所有计算机。</span><span class="sxs-lookup"><span data-stu-id="cb71c-143">The tool searches all the machines that are contained in the specified OU.</span></span> 
    
- <span data-ttu-id="cb71c-144">客户端和服务器计算机。</span><span class="sxs-lookup"><span data-stu-id="cb71c-144">Client and server computers.</span></span> <span data-ttu-id="cb71c-145">该工具将搜索指定的计算机。</span><span class="sxs-lookup"><span data-stu-id="cb71c-145">The tool searches the specified machines.</span></span> 
    
- <span data-ttu-id="cb71c-146">网络文件共享。</span><span class="sxs-lookup"><span data-stu-id="cb71c-146">Network file shares.</span></span> <span data-ttu-id="cb71c-147">该工具会搜索指定的网络文件共享。</span><span class="sxs-lookup"><span data-stu-id="cb71c-147">The tool searches the specified network file shares.</span></span> 
    
<span data-ttu-id="cb71c-148">请参阅以下过程中对 table 中参数的说明，以 `Locations` 获取用于每个位置类型的语法示例。</span><span class="sxs-lookup"><span data-stu-id="cb71c-148">See the description for the  `Locations` parameter in table in the following procedure for examples of the syntax to use for each of these location types.</span></span> 
  
> [!IMPORTANT]
> <span data-ttu-id="cb71c-149">您必须在 "查找" 模式下运行 "PST 集合" 工具，然后才能执行其他操作，例如阻止、收集或删除 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-149">You have to the run the PST Collection tool in the Find mode before you can perform other actions such as blocking, collecting, or deleting PST files.</span></span> 
  
1. <span data-ttu-id="cb71c-150">在您的本地计算机上打开命令提示符（以管理员身份运行）。</span><span class="sxs-lookup"><span data-stu-id="cb71c-150">Open a Command Prompt (run as administrator) on your local computer.</span></span>
    
2. <span data-ttu-id="cb71c-151">转到 PSTCollectionTool 文件夹（或您提取的 PSTCollectionTool.zip 文件的文件夹）。</span><span class="sxs-lookup"><span data-stu-id="cb71c-151">Go to the PSTCollectionTool folder (or the folder that you extracted the PSTCollectionTool.zip file to).</span></span>
    
3. <span data-ttu-id="cb71c-152">转到 DataCollectorMaster 目录。</span><span class="sxs-lookup"><span data-stu-id="cb71c-152">Change to the DataCollectorMaster directory.</span></span>
    
4. <span data-ttu-id="cb71c-153">运行以下命令，在指定位置查找 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-153">Run the following command to find PST files in a specified location.</span></span>
    
    ```powershell
    DataCollectorMaster.exe -DataSource Pst -Mode Find -JobName <Name> -Locations <Locations to search for PSTs> -LogLocation <Location to store log files> -ConfigurationLocation <Location to store configuration files>
    ```

    <span data-ttu-id="cb71c-154">下表介绍了运行 DataCollectorMaster.exe 命令查找 PST 文件时的参数及其必需值。</span><span class="sxs-lookup"><span data-stu-id="cb71c-154">The following table describes the parameters and their required values when you run the DataCollectorMaster.exe command to find PST files.</span></span> 
    
    |<span data-ttu-id="cb71c-155">参数 \* \* \* \*</span><span class="sxs-lookup"><span data-stu-id="cb71c-155">\*\*\*\*Parameter\*\*\*\*</span></span>|<span data-ttu-id="cb71c-156">\*\*\*\*说明\*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="cb71c-156">\*\*\*\*Description\*\*\*\*</span></span>|<span data-ttu-id="cb71c-157">示例 \* \* \* \*</span><span class="sxs-lookup"><span data-stu-id="cb71c-157">\*\*\*\*Examples\*\*\*\*</span></span>|
    |:-----|:-----|:-----|
    | `DataSource` <br/> |<span data-ttu-id="cb71c-158">指定要搜索的数据的类型。</span><span class="sxs-lookup"><span data-stu-id="cb71c-158">Specifies the type of data to search for.</span></span> <span data-ttu-id="cb71c-159">目前，您可以使用 "PST 集合" 工具搜索 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-159">Currently, you can use the PST Collection tool to search for PST files.</span></span>  <br/> | `-DataSource Pst` <br/> |
    | `Mode` <br/> |<span data-ttu-id="cb71c-160">指定工具将执行的操作的类型。</span><span class="sxs-lookup"><span data-stu-id="cb71c-160">Specifies the type of operation that the tool will perform.</span></span> <span data-ttu-id="cb71c-161">使用值 `Find` 在指定位置查找 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-161">Use the value  `Find` to locate PST files in the specified locations.</span></span> <span data-ttu-id="cb71c-162">请注意，该工具可以查找和获取有关在 Outlook 中打开的 PST 文件以及连接到 Outlook 配置文件的 PST 文件的信息。</span><span class="sxs-lookup"><span data-stu-id="cb71c-162">Note that the tool can find and get information about PST files that are open in Outlook and PST files that are connected to Outlook profiles.</span></span>  <br/> | `-Mode Find` <br/> |
    | `JobName` <br/> |<span data-ttu-id="cb71c-163">指定 PST 集合作业的名称。</span><span class="sxs-lookup"><span data-stu-id="cb71c-163">Specifies the name of the PST Collection job.</span></span> <span data-ttu-id="cb71c-164">在运行 PST 集合工具以阻止、收集和删除在运行该工具以查找 PST 文件时找到的 PST 文件时，将使用此相同的作业名称。</span><span class="sxs-lookup"><span data-stu-id="cb71c-164">You will use this same job name when you run the PST Collection tool to block, collect, and delete the PST files that are found when you run the tool to find PST files.</span></span> <span data-ttu-id="cb71c-165">此外，还会将作业名称添加到日志和配置文件名称中。</span><span class="sxs-lookup"><span data-stu-id="cb71c-165">The job name will also be added to the log and configuration file names.</span></span>  <br/> | `-JobName PstSearch1` <br/> |
    | `Locations` <br/> | <span data-ttu-id="cb71c-166">指定要在其中搜索 PST 文件的一个或多个位置。</span><span class="sxs-lookup"><span data-stu-id="cb71c-166">Specifies one or more locations to search for PST files.</span></span> <span data-ttu-id="cb71c-167">如果指定多个位置，请使用分号（;)分隔各个位置。</span><span class="sxs-lookup"><span data-stu-id="cb71c-167">If you specify more than one location, use a semi-colon (;) to separate individual locations.</span></span> <span data-ttu-id="cb71c-168">请务必用双引号（""）将此参数的各个值括起来。</span><span class="sxs-lookup"><span data-stu-id="cb71c-168">Be sure to surround the individual values of this parameter with double-quotation marks (" ").</span></span>  <br/><br/>   <span data-ttu-id="cb71c-169">下面是您可以搜索的位置类型所需的标识值格式。</span><span class="sxs-lookup"><span data-stu-id="cb71c-169">Here is the required identity value format for the types of locations that you can search.</span></span>  <br/><br/>        <span data-ttu-id="cb71c-170">**Ou** -使用可分辨名称（DN）标识 ou;例如：`"OU=NorthAmerica,OU=NWRegion,OU=ITServices,DC=contoso,DC=com"`</span><span class="sxs-lookup"><span data-stu-id="cb71c-170">**OUs** - Use the distinguished name (DN) to identify OUs; for example:  `"OU=NorthAmerica,OU=NWRegion,OU=ITServices,DC=contoso,DC=com"`</span></span> <br/> <span data-ttu-id="cb71c-171">> [!IMPORTANT]> 无法指定内置计算机容器（例如，CN = 计算机，DC = contoso，DC = com "），因为它不是一个组织单位。</span><span class="sxs-lookup"><span data-stu-id="cb71c-171">> [!IMPORTANT]>  You can't specify the built-in Computers container (for example, CN=Computers,DC=contoso,DC=com") because it isn't an organizational unit.</span></span><br/> <br/> <span data-ttu-id="cb71c-172">**计算机**-使用 DN 或完全限定的域名（FQDN）来标识网络上的客户端和服务器计算机;例如：</span><span class="sxs-lookup"><span data-stu-id="cb71c-172">**Machines** - Use the DN or the fully qualified domain name (FQDN) to identify client and server machines on your network; for example:</span></span>  <br/>  <span data-ttu-id="cb71c-173">DN`"CN=FILESERVER01,CN=Computers,DC=contoso,DC=com"`</span><span class="sxs-lookup"><span data-stu-id="cb71c-173">DN:  `"CN=FILESERVER01,CN=Computers,DC=contoso,DC=com"`</span></span> <br/>  <span data-ttu-id="cb71c-174">或</span><span class="sxs-lookup"><span data-stu-id="cb71c-174">Or</span></span>  <br/>  <span data-ttu-id="cb71c-175">域名`"FILESERVER01.contoso.com"`</span><span class="sxs-lookup"><span data-stu-id="cb71c-175">FQDN:  `"FILESERVER01.contoso.com"`</span></span> <br/><br/>  <span data-ttu-id="cb71c-176">**网络文件共享**-使用 UNC 名称来标识网络文件共享;例如，`"\\FILESERVER02\Users"`</span><span class="sxs-lookup"><span data-stu-id="cb71c-176">**Network file shares** - Use a UNC name to identify network file shares; for example,  `"\\FILESERVER02\Users"`</span></span> <br/> | `-Locations "CN=FILESERVER01,CN=Computers,DC=contoso,DC=com";"CN=FILESERVER02,CN=Computers,DC=contoso,DC=com"` <br/> |
    | `LogLocation` <br/> |<span data-ttu-id="cb71c-177">指定要将日志文件复制到的文件夹。</span><span class="sxs-lookup"><span data-stu-id="cb71c-177">Specifies the folder that the log files will be copied to.</span></span> <span data-ttu-id="cb71c-178">如果该文件夹不存在，则会在运行该工具时创建该文件夹。</span><span class="sxs-lookup"><span data-stu-id="cb71c-178">If the folder doesn't exist, it will be created when you run the tool.</span></span>  <br/> | `-LogLocation "c:\users\admin\desktop\PSTCollection"` <br/> |
    | `ConfigurationLocation` <br/> |<span data-ttu-id="cb71c-179">指定将把 .xml 配置文件复制到的文件夹。</span><span class="sxs-lookup"><span data-stu-id="cb71c-179">Specifies the folder that the .xml configuration file will be copied to.</span></span> <span data-ttu-id="cb71c-180">此文件包含在运行该工具时找到的每个 PST 文件的相关信息。</span><span class="sxs-lookup"><span data-stu-id="cb71c-180">This file contains information about each PST file that is found when you run the tool.</span></span> <span data-ttu-id="cb71c-181">当您在步骤3中运行该工具以复制找到的 PST 文件时，将使用此文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-181">This file will be used when you run the tool in Step 3 to copy the PST files that are found.</span></span>  <br/> | `-ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration"` <br/> |
    | `ExcludedLocations` <br/> |<span data-ttu-id="cb71c-182">此可选参数指定在查找操作过程中要跳过的位置。</span><span class="sxs-lookup"><span data-stu-id="cb71c-182">This optional parameter specifies locations to skip during a Find operation.</span></span> <span data-ttu-id="cb71c-183">您可以排除特定 Ou、计算机和网络文件共享。</span><span class="sxs-lookup"><span data-stu-id="cb71c-183">You can exclude specific OUs, machines, and network file shares.</span></span> <span data-ttu-id="cb71c-184">例如，您可以排除计算机，如配置为 SQL server 的计算机（或其他类型的应用程序服务器），用户无法访问这些计算机。</span><span class="sxs-lookup"><span data-stu-id="cb71c-184">For example, you could exclude machines, such as machine configured as a SQL server (or other kinds of application servers), that users don't have access to.</span></span> <span data-ttu-id="cb71c-185">如果指定要排除的一个或多个位置，请使用分号（;)分隔各个位置。</span><span class="sxs-lookup"><span data-stu-id="cb71c-185">If you specify more than one location to exclude, use a semi-colon (;) to separate individual locations.</span></span> <span data-ttu-id="cb71c-186">请务必用双引号（""）将此参数的各个值括起来。</span><span class="sxs-lookup"><span data-stu-id="cb71c-186">Be sure to surround the individual values of this parameter with double-quotation marks (" ").</span></span>  <br/> | `-ExcludedLocations "SQLSERVER01.contoso.com"` <br/> |
    | `ForceRestart` <br/> |<span data-ttu-id="cb71c-187">此可选开关允许您在 "查找" 模式下为现有的 PST 集合作业运行该工具。</span><span class="sxs-lookup"><span data-stu-id="cb71c-187">This optional switch lets you run the tool in the Find mode for an existing PST Collection job.</span></span> <span data-ttu-id="cb71c-188">使用此开关时 `ForceRestart` ，将丢弃作业的上一个查找操作的结果，并且该工具将重新扫描指定的位置并创建新的日志和配置文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-188">When you use the  `ForceRestart` switch, the results from the previous Find operation for the job will be discarded, and the tool will re-scan the specified locations and create new log and configuration files.</span></span>  <br/> | `-ForceRestart` <br/> |
   
    <span data-ttu-id="cb71c-189">下面的示例展示了使用每个参数的实际值的 DataCollectorMaster.exe 命令的语法：</span><span class="sxs-lookup"><span data-stu-id="cb71c-189">Here's an example of the syntax for the DataCollectorMaster.exe command using actual values for each parameter:</span></span>
    
    ```powershell
    DataCollectorMaster.exe -DataSource Pst -Mode Find -JobName PstSearch1 -Locations "CN=FILESERVER01,CN=Computers,DC=contoso,DC=com";"CN=FILESERVER02,CN=Computers,DC=contoso,DC=com" -LogLocation "c:\users\admin\desktop\PSTCollection" -ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration"
    ```

    <span data-ttu-id="cb71c-190">运行命令后，将显示详细的状态消息，显示在指定位置查找 PST 文件的进度。</span><span class="sxs-lookup"><span data-stu-id="cb71c-190">After you run the command, detailed status messages are displayed that show the progress of finding PST files in the specified locations.</span></span> <span data-ttu-id="cb71c-191">一段时间后，最终状态邮件会显示找到的 PST 文件总数、作业是否已完成以及是否有任何错误。</span><span class="sxs-lookup"><span data-stu-id="cb71c-191">After a while, a final status message shows the total number of PST files that were found, whether the job has completed, and if there were any errors.</span></span> <span data-ttu-id="cb71c-192">将相同的状态邮件复制到 .log 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-192">The same status messages are copied to the .log file.</span></span>
    
### <a name="results-of-running-datacollectormasterexe-in-the-find-mode"></a><span data-ttu-id="cb71c-193">在查找模式下运行 DataCollectorMaster.exe 的结果</span><span class="sxs-lookup"><span data-stu-id="cb71c-193">Results of running DataCollectorMaster.exe in the Find mode</span></span>

<span data-ttu-id="cb71c-194">在成功运行 PST 集合工具的 "查找" 模式后，将创建以下文件并将其存储在由和参数指定的文件夹中 `LogLocation` `ConfigurationLocation` 。</span><span class="sxs-lookup"><span data-stu-id="cb71c-194">After you successfully run the PST Collection tool the Find mode, the following files are created and stored in the folders specified by the  `LogLocation` and  `ConfigurationLocation` parameters.</span></span> 
  
- <span data-ttu-id="cb71c-195">\*\* \<JobName\> _查找_ \<DateTimeStamp\> \*\* .log-日志文件包含显示的状态消息。</span><span class="sxs-lookup"><span data-stu-id="cb71c-195">**\<JobName\>_Find_\<DateTimeStamp\>.log** - The log file contains the status messages that were displayed.</span></span> <span data-ttu-id="cb71c-196">此文件在由参数指定的文件夹中创建 `LogLocation` 。</span><span class="sxs-lookup"><span data-stu-id="cb71c-196">This file is created in the folder specified by the  `LogLocation` parameter.</span></span> 
    
- <span data-ttu-id="cb71c-197">\*\* \<JobName\> _查找_ \<DateTimeStamp\> .csv\*\* -csv 文件包含每个找到的 PST 文件对应的行。</span><span class="sxs-lookup"><span data-stu-id="cb71c-197">**\<JobName\>_Find_\<DateTimeStamp\>.csv** - The CSV file contains a row for each PST file that was found.</span></span> <span data-ttu-id="cb71c-198">每个 PST 的信息包括找到 PST 文件的计算机、PST 文件的完整文件路径位置、PST 文件的所有者以及 PST 文件的大小（以 kb、Kb）。</span><span class="sxs-lookup"><span data-stu-id="cb71c-198">The information for each PST includes the computer where the PST file was found, the full file path location of the PST file, the owner of the PST file, and the size (in kilobytes, KBs) of the PST file.</span></span> <span data-ttu-id="cb71c-199">此文件在由参数指定的文件夹中创建 `LogLocation` 。</span><span class="sxs-lookup"><span data-stu-id="cb71c-199">This file is created in the folder specified by the  `LogLocation` parameter.</span></span> 
    
    > [!TIP]
    > <span data-ttu-id="cb71c-200">使用 Excel 中的 "自动求和" 工具计算 CSV 文件中列出的所有 PST 文件的总大小（以 KB 为单位）。</span><span class="sxs-lookup"><span data-stu-id="cb71c-200">Use the AutoSum tool in Excel to calculate the total size (in KB) of all the PST files listed in the CSV file.</span></span> <span data-ttu-id="cb71c-201">然后，可以使用转换计算器将总大小转换为兆字节（MB）或千兆字节（GB）。</span><span class="sxs-lookup"><span data-stu-id="cb71c-201">Then you can use a conversion calculator to convert the total size to megabytes (MB) or gigabytes (GB).</span></span> 
  
- <span data-ttu-id="cb71c-202">\*\* \<JobName\> _Find_ \<DateTimeStamp\> \*\* -xml 文件包含在 "查找" 模式下运行该工具时使用的参数值的相关信息。</span><span class="sxs-lookup"><span data-stu-id="cb71c-202">**\<JobName\>_Find_\<DateTimeStamp\>.xml** - The XML file contains information about the parameter values that where used when you ran the tool in the Find mode.</span></span> <span data-ttu-id="cb71c-203">此文件还包含有关找到的每个 PST 文件的信息。</span><span class="sxs-lookup"><span data-stu-id="cb71c-203">This file also contains information about every PST file that was found.</span></span> <span data-ttu-id="cb71c-204">当您运行同一作业的工具以阻止、收集或删除找到的 PST 文件时，将使用此文件中的数据。</span><span class="sxs-lookup"><span data-stu-id="cb71c-204">The data in this file is used when you run re-run the tool for the same job to block, collect, or delete the PST files that were found.</span></span> <span data-ttu-id="cb71c-205">此文件在由参数指定的文件夹中创建 `ConfigurationLocation` 。</span><span class="sxs-lookup"><span data-stu-id="cb71c-205">This file is created in the folder specified by the  `ConfigurationLocation` parameter.</span></span> 
    
    > [!IMPORTANT]
    > <span data-ttu-id="cb71c-206">请勿重命名、更改或移动此文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-206">Don't rename, change, or move this file.</span></span> <span data-ttu-id="cb71c-207">当您在相同作业的阻止、复制或删除模式下重新运行该工具时，它将由 PST 收集工具使用。</span><span class="sxs-lookup"><span data-stu-id="cb71c-207">It's used by the PST Collection tool when you re-run the tool in the Block, Copy, or Delete mode for the same job.</span></span> 

## <a name="optional-step-2-control-access-to-pst-files"></a><span data-ttu-id="cb71c-208">Optional步骤2：控制对 PST 文件的访问</span><span class="sxs-lookup"><span data-stu-id="cb71c-208">(Optional) Step 2: Control access to PST files</span></span>

<span data-ttu-id="cb71c-209">此可选步骤允许您 "锁定" 在步骤1中找到的 PST 文件，以便您可以将一组已知的 PST 文件收集并导入到 Office 365。</span><span class="sxs-lookup"><span data-stu-id="cb71c-209">This optional step lets you "lock down" the PST files that were found in Step 1 so that you can collect and import a known set of PST files to Office 365.</span></span> <span data-ttu-id="cb71c-210">当您在阻止模式下运行 PST 集合工具时，会发生以下情况：</span><span class="sxs-lookup"><span data-stu-id="cb71c-210">When you run the PST Collection tool in the Block mode, the following things happen:</span></span> 
  
- <span data-ttu-id="cb71c-211">该工具将创建一个名为 " *PST Usage Controls* " 的组策略对象（GPO）。</span><span class="sxs-lookup"><span data-stu-id="cb71c-211">The tool creates a Group Policy Object (GPO) named  *PST Usage Controls*  .</span></span> <span data-ttu-id="cb71c-212">此 GPO 链接到你的域，并适用于组织中的所有经过身份验证的用户。</span><span class="sxs-lookup"><span data-stu-id="cb71c-212">This GPO is linked to your domain, and applies to all authenticated users in your organization.</span></span> 
    
- <span data-ttu-id="cb71c-213">PST 用法控制 GPO 在组织中的计算机上创建注册表设置。</span><span class="sxs-lookup"><span data-stu-id="cb71c-213">The PST Usage Controls GPO creates registry settings on machines in your organization.</span></span> <span data-ttu-id="cb71c-214">根据您使用的参数，您可以创建注册表设置，以阻止用户创建新的 PST 文件和注册表设置，以防止用户更改现有的 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-214">Depending on the parameter that you use, you can create a registry setting to prevent users from creating new PST files and a registry setting that prevents users from changing existing PST files.</span></span>
    
> [!NOTE]
> <span data-ttu-id="cb71c-215">如果控制对您的组织的访问 PST 文件的访问过严重，则可以考虑跳过此步骤，并执行步骤3，将 PST 文件复制到一个中心位置。</span><span class="sxs-lookup"><span data-stu-id="cb71c-215">If controlling access to PST files is too disruptive for your organization, you might consider skipping this step, and performing Step 3 to copy PST files to a central location.</span></span> <span data-ttu-id="cb71c-216">然后，可以为同一作业（通过使用参数）重复步骤1， `ForceRestart` 以查找在将 pst 文件复制到集合位置之后创建的其他 pst 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-216">Then you can repeat Step 1 for the same job (by using the  `ForceRestart` parameter) to find additional PSTs files that were created after you copied PSTs files to the collection location.</span></span> <span data-ttu-id="cb71c-217">如果找到了新的 PST 文件，则可以将其复制到集合位置。</span><span class="sxs-lookup"><span data-stu-id="cb71c-217">If new PST files are found, you can copy them to the collection location.</span></span> <span data-ttu-id="cb71c-218">当您 `ForceRestart` 在 "查找" 模式下重新运行该工具时使用该参数时，将放弃针对某个作业的以前的查找操作的结果，并且该工具将重新扫描指定的位置。</span><span class="sxs-lookup"><span data-stu-id="cb71c-218">When you use the  `ForceRestart` parameter when you re-run the tool in the Find mode, the results from the previous Find operation for a job will be discarded, and the tool will re-scan the specified locations.</span></span> 

<span data-ttu-id="cb71c-219">若要阻止对 PST 文件的访问，请执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="cb71c-219">To block access to PST files:</span></span>

1. <span data-ttu-id="cb71c-220">在您的本地计算机上打开命令提示符（以管理员身份运行）。</span><span class="sxs-lookup"><span data-stu-id="cb71c-220">Open a Command Prompt (run as administrator) on your local computer.</span></span>
    
2. <span data-ttu-id="cb71c-221">转到您在其中下载了 PST 集合工具的目录。</span><span class="sxs-lookup"><span data-stu-id="cb71c-221">Go to the directory where you downloaded the PST Collection tool to.</span></span>
    
3. <span data-ttu-id="cb71c-222">运行以下命令，以阻止对在步骤1中找到的 PST 文件的访问。</span><span class="sxs-lookup"><span data-stu-id="cb71c-222">Run the following command to block access to the PST files found in Step 1.</span></span>

    ```powershell
    DataCollectorMaster.exe -DataSource Pst -Mode Block -JobName <Name of job from Step 1> -ConfigurationLocation <Location of configuration files from Step 1> -BlockChangesToFiles -BlockNewFiles
    ```

    <span data-ttu-id="cb71c-223">下表介绍了在运行 DataCollectorMaster.exe 命令以阻止创建和更改 PST 文件时所需的参数及其所需的值。</span><span class="sxs-lookup"><span data-stu-id="cb71c-223">The following table describes the parameters and their required values when you run the DataCollectorMaster.exe command to block the creation and changing of PST files.</span></span> 
    
    |<span data-ttu-id="cb71c-224">参数 \* \* \* \*</span><span class="sxs-lookup"><span data-stu-id="cb71c-224">\*\*\*\*Parameter\*\*\*\*</span></span>|<span data-ttu-id="cb71c-225">\*\*\*\*说明\*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="cb71c-225">\*\*\*\*Description\*\*\*\*</span></span>|<span data-ttu-id="cb71c-226">示例 \* \* \* \*</span><span class="sxs-lookup"><span data-stu-id="cb71c-226">\*\*\*\*Examples\*\*\*\*</span></span>|
    |:-----|:-----|:-----|
    | `DataSource` <br/> |<span data-ttu-id="cb71c-227">指定要搜索的数据的类型。</span><span class="sxs-lookup"><span data-stu-id="cb71c-227">Specifies the type of data to search for.</span></span> <span data-ttu-id="cb71c-228">目前，您可以使用 "PST 集合" 工具搜索 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-228">Currently, you can use the PST Collection tool to search for PST files.</span></span>  <br/> | `-DataSource Pst` <br/> |
    | `Mode` <br/> |<span data-ttu-id="cb71c-229">指定工具将执行的操作的类型。</span><span class="sxs-lookup"><span data-stu-id="cb71c-229">Specifies the type of operation that the tool will perform.</span></span> <span data-ttu-id="cb71c-230">使用此值 `Block` 可阻止用户创建新的 pst 文件并对现有的 pst 文件进行更改。</span><span class="sxs-lookup"><span data-stu-id="cb71c-230">Use the value  `Block` to prevent users from creating new PST files and making changes to existing PST files.</span></span>  <br/> | `-Mode Block` <br/> |
    | `JobName` <br/> |<span data-ttu-id="cb71c-231">指定现有 PST 集合作业的名称。</span><span class="sxs-lookup"><span data-stu-id="cb71c-231">Specifies the name of an existing PST Collection job.</span></span> <span data-ttu-id="cb71c-232">您必须使用在第1步中的 "查找" 模式下运行该工具时使用的相同作业名称。</span><span class="sxs-lookup"><span data-stu-id="cb71c-232">You have to use this same job name that you used when you ran the tool in the Find mode in Step 1.</span></span> <span data-ttu-id="cb71c-233">此外，还会将此作业名称添加到在阻止模式下运行该工具时创建的日志文件的名称。</span><span class="sxs-lookup"><span data-stu-id="cb71c-233">This job name is also added to the name of the log file that is created when you run the tool in the Block mode.</span></span>  <br/> | `-JobName PstSearch1` <br/> |
    | `ConfigurationLocation` <br/> |<span data-ttu-id="cb71c-234">指定文件夹包含在 "查找" 模式下运行该工具时创建的 .xml 配置文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-234">Specifies the folder contains the .xml configuration file that was created when you ran the tool in the Find mode.</span></span> <span data-ttu-id="cb71c-235">使用您在步骤1中用于此参数的相同值。</span><span class="sxs-lookup"><span data-stu-id="cb71c-235">Use the same value that you used for this parameter in Step 1.</span></span>  <br/> | `-ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration"` <br/> |
    | `LogLocation` <br/> |<span data-ttu-id="cb71c-236">指定将阻止操作的日志文件复制到的文件夹。</span><span class="sxs-lookup"><span data-stu-id="cb71c-236">Specifies the folder that the log file for the Block operation will be copied to.</span></span> <span data-ttu-id="cb71c-237">这是一个可选参数。</span><span class="sxs-lookup"><span data-stu-id="cb71c-237">This is an optional parameter.</span></span> <span data-ttu-id="cb71c-238">如果不包含此文件，则会将日志文件复制到您在其中下载 PST 集合工具的文件夹。</span><span class="sxs-lookup"><span data-stu-id="cb71c-238">If you don't include it, the log file is copied to the folder where you downloaded the PST Collection tool to.</span></span> <span data-ttu-id="cb71c-239">考虑在第1步中的 "查找" 模式下运行该工具时使用的相同日志位置，以便将所有日志文件保存在同一文件夹中。</span><span class="sxs-lookup"><span data-stu-id="cb71c-239">Consider using the same log location that you used when you ran the tool in the Find mode in Step 1 so that all the log files are saved in the same folder.</span></span>  <br/> | `-LogLocation "c:\users\admin\desktop\PSTCollection"` <br/> |
    | `BlockChangesToFiles` <br/> |<span data-ttu-id="cb71c-240">使用此开关可阻止用户更改 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-240">Use this switch to prevent users from changing a PST file.</span></span> <span data-ttu-id="cb71c-241">使用此开关时，将创建以下注册表项：并将 `HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\<version>\Outlook\PST\PstDisableGrow` 数据值设置为1。</span><span class="sxs-lookup"><span data-stu-id="cb71c-241">When you use this switch, the following registry entry is created:  `HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\<version>\Outlook\PST\PstDisableGrow` and the data value is set to 1.</span></span> <span data-ttu-id="cb71c-242">在您的组织中的计算机上创建此注册表设置，该 GPO 在您在阻止模式下运行 PST 集合工具时创建。</span><span class="sxs-lookup"><span data-stu-id="cb71c-242">This registry setting is created on the machines in your organization by the GPO that's created when you run the PST Collection tool in the Block mode.</span></span>  <br/> | `-BlockChangesToFiles` <br/> |
    | `BlockNewFiles` <br/> |<span data-ttu-id="cb71c-243">使用此开关可阻止用户创建新的 PST 文件、打开和导入 PST 文件并将其导入 outlook，以及从 Outlook 导出 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-243">Use this switch to prevent users from creating new PST files, opening and importing PST files to Outlook, and exporting PST files from Outlook.</span></span> <span data-ttu-id="cb71c-244">使用此开关时，将创建以下注册表项：并将 `HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\<version>\Outlook\DisablePst` 数据值设置为1。</span><span class="sxs-lookup"><span data-stu-id="cb71c-244">When you use this switch, the following registry entry is created:  `HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\<version>\Outlook\DisablePst` and the data value is set to 1.</span></span> <span data-ttu-id="cb71c-245">在您的组织中的计算机上创建此注册表设置，该 GPO 在您在阻止模式下运行 PST 集合工具时创建。</span><span class="sxs-lookup"><span data-stu-id="cb71c-245">This registry setting is created on the machines in your organization by the GPO that's created when you run the PST Collection tool in the Block mode.</span></span>  <br/> | `-BlockNewFiles` <br/> |
   
    <span data-ttu-id="cb71c-246">下面的示例展示了使用每个参数的实际值的 DataCollectorMaster.exe 命令的语法：</span><span class="sxs-lookup"><span data-stu-id="cb71c-246">Here's an example of the syntax for the DataCollectorMaster.exe command using actual values for each parameter:</span></span>

    ```powershell
    DataCollectorMaster.exe -DataSource Pst -Mode Block -JobName PstSearch1 -ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration" -LogLocation "c:\users\admin\desktop\PSTCollection" -BlockChangesToFiles -BlockNewFiles
    ```

    <span data-ttu-id="cb71c-247">系统将提示您确认是否要阻止新的 PST 文件或对现有 PST 文件所做的更改。</span><span class="sxs-lookup"><span data-stu-id="cb71c-247">You are prompted to confirm that you want to block new PST files or changes to existing PST files.</span></span> <span data-ttu-id="cb71c-248">在您确认要继续运行该命令后，会显示一条消息，指出已创建一个名为 "PST Usage Controls" 的新 GPO。</span><span class="sxs-lookup"><span data-stu-id="cb71c-248">After you confirm that you want to continue and the command successfully runs, a message is displayed saying that a new GPO, named "PST Usage Controls", has been created.</span></span>
    
## <a name="step-3-copy-the-pst-files-to-a-collection-location"></a><span data-ttu-id="cb71c-249">步骤3：将 PST 文件复制到集合位置</span><span class="sxs-lookup"><span data-stu-id="cb71c-249">Step 3: Copy the PST files to a collection location</span></span>

<span data-ttu-id="cb71c-250">下一步是复制在 "查找" 模式下运行 PST 集合工具时找到的 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-250">The next step is to copy the PST files that where found when you ran the PST Collection tool in the Find mode.</span></span> <span data-ttu-id="cb71c-251">这样，您可以在一个位置收集 PST 文件，以便以后将其导入 Office 365。</span><span class="sxs-lookup"><span data-stu-id="cb71c-251">This lets you collect the PST files in one location so that you can later import them to Office 365.</span></span> <span data-ttu-id="cb71c-252">将 PST 文件复制到集合位置之前，请考虑确定所需的总存储空间量。</span><span class="sxs-lookup"><span data-stu-id="cb71c-252">Before you copy the PST files to collection location, consider determining the total amount of storage space that is required.</span></span> <span data-ttu-id="cb71c-253">您可以使用在第1步中创建的 CSV 文件来计算所有 PST 文件的总大小。</span><span class="sxs-lookup"><span data-stu-id="cb71c-253">You can do this using the CSV file that was created in Step 1 to calculate the total size of all PST files.</span></span>
  
> [!NOTE]
> <span data-ttu-id="cb71c-254">将 PST 文件导入到 Microsoft 365 并将其从原始位置删除后，您可能希望在此步骤中将其从复制它们的集合位置中删除。</span><span class="sxs-lookup"><span data-stu-id="cb71c-254">After you've imported the PST files to Microsoft 365 and deleted them from their original location, you might want to delete them from the collection location that you copied them to in this step.</span></span> 
  
1. <span data-ttu-id="cb71c-255">在您的本地计算机上打开命令提示符（以管理员身份运行）。</span><span class="sxs-lookup"><span data-stu-id="cb71c-255">Open a Command Prompt (run as administrator) on your local computer.</span></span>
    
2. <span data-ttu-id="cb71c-256">转到您在其中下载了 PST 集合工具的目录。</span><span class="sxs-lookup"><span data-stu-id="cb71c-256">Go to the directory where you downloaded the PST Collection tool to.</span></span>
    
3. <span data-ttu-id="cb71c-257">运行以下命令，将 PST 文件复制到指定位置。</span><span class="sxs-lookup"><span data-stu-id="cb71c-257">Run the following command to copy the PST files to a specified location.</span></span>
    
    ```powershell
    DataCollectorMaster.exe -DataSource Pst -Mode Collect -JobName <Name of job from Step 1> -Locations <same locations from Step 1> -ConfigurationLocation <Location of configuration files from Step 1> -CopyLocation <Location to copy PST files to>
    ```

    <span data-ttu-id="cb71c-258">下表介绍了运行 DataCollectorMaster.exe 命令复制 PST 文件时的参数及其必需值。</span><span class="sxs-lookup"><span data-stu-id="cb71c-258">The following table describes the parameters and their required values when you run the DataCollectorMaster.exe command to copy PST files.</span></span> 
    
    |<span data-ttu-id="cb71c-259">参数 \* \* \* \*</span><span class="sxs-lookup"><span data-stu-id="cb71c-259">\*\*\*\*Parameter\*\*\*\*</span></span>|<span data-ttu-id="cb71c-260">\*\*\*\*说明\*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="cb71c-260">\*\*\*\*Description\*\*\*\*</span></span>|<span data-ttu-id="cb71c-261">示例 \* \* \* \*</span><span class="sxs-lookup"><span data-stu-id="cb71c-261">\*\*\*\*Examples\*\*\*\*</span></span>|
    |:-----|:-----|:-----|
    | `DataSource` <br/> |<span data-ttu-id="cb71c-262">指定要搜索的数据的类型。</span><span class="sxs-lookup"><span data-stu-id="cb71c-262">Specifies the type of data to search for.</span></span> <span data-ttu-id="cb71c-263">目前，您可以使用 "PST 集合" 工具搜索 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-263">Currently, you can use the PST Collection tool to search for PST files.</span></span>  <br/> | `-DataSource Pst` <br/> |
    | `Mode` <br/> |<span data-ttu-id="cb71c-264">指定工具将执行的操作的类型。</span><span class="sxs-lookup"><span data-stu-id="cb71c-264">Specifies the type of operation that the tool will perform.</span></span> <span data-ttu-id="cb71c-265">使用值 `Collect` 可复制在 "查找" 模式下运行到该工具时找到的 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-265">Use the value  `Collect` to copy that PST files that were found when you ran to the tool in the Find mode.</span></span> <span data-ttu-id="cb71c-266">请注意，该工具能够复制在 Outlook 中打开的 PST 文件，并复制连接到 Outlook 配置文件的 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-266">Note that the tool is able copy PST files that are open in Outlook and copy PST files that are connected to Outlook profiles.</span></span>  <br/> | `-Mode Collect` <br/> |
    | `JobName` <br/> |<span data-ttu-id="cb71c-267">指定现有 PST 集合作业的名称。</span><span class="sxs-lookup"><span data-stu-id="cb71c-267">Specifies the name of an existing PST Collection job.</span></span> <span data-ttu-id="cb71c-268">您必须使用在第1步中的 "查找" 模式下运行该工具时使用的相同作业名称。</span><span class="sxs-lookup"><span data-stu-id="cb71c-268">You have to use this same job name that you used when you ran the tool in the Find mode in Step 1.</span></span> <span data-ttu-id="cb71c-269">此外，还会将此作业名称添加到在收集模式下运行该工具时创建的日志文件的名称。</span><span class="sxs-lookup"><span data-stu-id="cb71c-269">This job name is also added to the name of the log file that is created when you run the tool in the Collect mode.</span></span>  <br/> | `-JobName PstSearch1` <br/> |
    | `Locations` <br/> |<span data-ttu-id="cb71c-270">使用您在 `Locations` 步骤1中用于参数的相同值。</span><span class="sxs-lookup"><span data-stu-id="cb71c-270">Use the same value that you used for the  `Locations` parameter in Step 1.</span></span> <span data-ttu-id="cb71c-271">当您在收集模式下运行该工具时，如果要在步骤5中重新运行该工具以删除其源位置中的 PST 文件，则必须包含此参数。</span><span class="sxs-lookup"><span data-stu-id="cb71c-271">You have include this parameter when you run the tool in the Collect mode if you want to re-run the tool to delete the PST files from their source location in Step 5.</span></span>  <br/> | `-Locations "CN=FILESERVER01,CN=Computers,DC=contoso,DC=com"; "CN=FILESERVER02,CN=Computers,DC=contoso,DC=com"` <br/> |
    | `ConfigurationLocation` <br/> |<span data-ttu-id="cb71c-272">指定包含在 "查找" 模式下运行该工具时所创建的 .xml 配置文件的文件夹。</span><span class="sxs-lookup"><span data-stu-id="cb71c-272">Specifies the folder that contains the .xml configuration file that was created when you ran the tool in the Find mode.</span></span> <span data-ttu-id="cb71c-273">使用您在步骤1中用于此参数的相同值。</span><span class="sxs-lookup"><span data-stu-id="cb71c-273">Use the same value that you used for this parameter in Step 1.</span></span>  <br/> | `-ConfigurationLocation "c:\users\admin\desktop \PSTCollection\Configuration"` <br/> |
    | `CopyLocation` <br/> |<span data-ttu-id="cb71c-274">指定要将 PST 文件复制到的集合位置。</span><span class="sxs-lookup"><span data-stu-id="cb71c-274">Specifies the collection location where you want to copy the PST files to.</span></span> <span data-ttu-id="cb71c-275">您可以将文件复制到文件服务器、网络文件共享或硬盘。</span><span class="sxs-lookup"><span data-stu-id="cb71c-275">You can copy files to a file server, a network file share, or a hard drive.</span></span> <span data-ttu-id="cb71c-276">在收集模式下运行该工具之前，该位置必须存在。</span><span class="sxs-lookup"><span data-stu-id="cb71c-276">The location must exist before you run the tool in the Collect mode.</span></span> <span data-ttu-id="cb71c-277">该工具不会创建位置，并将返回错误消息，指出它不存在。</span><span class="sxs-lookup"><span data-stu-id="cb71c-277">The tool doesn't create the location, and will return an error saying that it doesn't exist.</span></span>  <br/> <span data-ttu-id="cb71c-278">此外，您还必须向此参数指定的集合位置写入权限。</span><span class="sxs-lookup"><span data-stu-id="cb71c-278">Also, you have to write permissions to the collection location specified by this parameter.</span></span>  <br/><br/><span data-ttu-id="cb71c-279">如果要使用语法将 PST 文件复制到的设备不可见 `\\SERVER\SHARE` ，请将驱动器号映射到设备，并将映射的驱动器号用于此参数的值。</span><span class="sxs-lookup"><span data-stu-id="cb71c-279">If the device that you want to copy the PST files to isn't visible by using the `\\SERVER\SHARE` syntax, then map a drive letter to the device and use the mapped drive letter for the value of this parameter.</span></span> | `-CopyLocation "\\FILESERVER03\PSTs"` <br/><span data-ttu-id="cb71c-280">或</span><span class="sxs-lookup"><span data-stu-id="cb71c-280">Or</span></span><br/>`-CopyLocation "z:\"`|
    | `LogLocation` <br/> |<span data-ttu-id="cb71c-281">指定要将收集模式的日志文件复制到的文件夹。</span><span class="sxs-lookup"><span data-stu-id="cb71c-281">Specifies the folder that the log file for the Collect mode will be copied to.</span></span> <span data-ttu-id="cb71c-282">这是一个可选参数。</span><span class="sxs-lookup"><span data-stu-id="cb71c-282">This is an optional parameter.</span></span> <span data-ttu-id="cb71c-283">如果不包含此文件，则会将日志文件复制到您在其中下载 PST 集合工具的文件夹。</span><span class="sxs-lookup"><span data-stu-id="cb71c-283">If you don't include it, the log file is copied to the folder where you downloaded the PST Collection tool to.</span></span> <span data-ttu-id="cb71c-284">考虑在第1步中的 "查找" 模式下运行该工具时使用的相同日志位置，以便将所有日志文件保存在同一文件夹中。</span><span class="sxs-lookup"><span data-stu-id="cb71c-284">Consider using the same log location that you used when you ran the tool in the Find mode in Step 1 so that all the log files are saved in the same folder.</span></span>  <br/> | `-LogLocation "c:\users\admin\desktop\PSTCollection"` <br/> |
    | `ForceRestart` <br/> |<span data-ttu-id="cb71c-285">此可选开关允许您在集合模式下为现有的 PST 集合作业重新运行该工具。</span><span class="sxs-lookup"><span data-stu-id="cb71c-285">This optional switch lets you re-run the tool in the Collection mode for an existing PST Collection job.</span></span> <span data-ttu-id="cb71c-286">如果您以前在收集模式下运行该工具，但随后在查找模式下再次运行该工具 `ForceRestart` 以重新扫描 PST 文件的位置，则可以使用此开关在 "收集" 模式下重新运行该工具，并重新复制在重新扫描位置时找到的 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-286">If you previously ran the tool in the Collect mode, but then ran the tool again in the Find mode with the  `ForceRestart` switch to re-scan locations for PST files, you can use this switch to re-run the tool in Collection mode and re-copy the PST files there were found when your re-scanned the locations.</span></span> <span data-ttu-id="cb71c-287">`ForceRestart`在收集模式下使用切换时，该工具将忽略任何以前的集合操作，并尝试从头开始复制 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-287">When using the  `ForceRestart` switch in Collection mode, the tool ignores any previous Collection operations and attempts to copy the PST files from scratch.</span></span>  <br/> | `-ForceRestart` <br/> |
   
    <span data-ttu-id="cb71c-288">下面的示例展示了使用每个参数的实际值的 DataCollectorMaster.exe 工具的语法：</span><span class="sxs-lookup"><span data-stu-id="cb71c-288">Here's an example of the syntax for the DataCollectorMaster.exe tool using actual values for each parameter:</span></span>
    
    ```powershell
    DataCollectorMaster.exe -DataSource Pst -Mode Collect -JobName PstSearch1 -Locations "CN=FILESERVER01,CN=Computers,DC=contoso,DC=com";"CN=FILESERVER02,CN=Computers,DC=contoso,DC=com" -ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration" -CopyLocation "\\FILESERVER03\PSTs" -LogLocation "c:\users\admin\desktop\PSTCollection"
    ```

    <span data-ttu-id="cb71c-289">运行命令后，将显示详细的状态消息，显示收集在步骤1中找到的 PST 文件的进度。</span><span class="sxs-lookup"><span data-stu-id="cb71c-289">After you run the command, detailed status messages are displayed that show the progress of collecting the PST files that were found in Step 1.</span></span> <span data-ttu-id="cb71c-290">一段时间后，最终状态消息将显示是否存在任何错误以及日志复制到的位置。</span><span class="sxs-lookup"><span data-stu-id="cb71c-290">After a while, a final status message shows if there were any errors and the location that the log is copied to.</span></span> <span data-ttu-id="cb71c-291">将相同的状态邮件复制到 .log 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-291">The same status messages are copied to the .log file.</span></span>
    
### <a name="results-of-running-datacollectormasterexe-in-the-collect-mode"></a><span data-ttu-id="cb71c-292">在收集模式下运行 DataCollectorMaster.exe 的结果</span><span class="sxs-lookup"><span data-stu-id="cb71c-292">Results of running DataCollectorMaster.exe in the Collect mode</span></span>

<span data-ttu-id="cb71c-293">在收集模式下成功运行 DataCollectorMaster.exe 后，将创建以下文件并将其存储在由和参数指定的文件夹中 `LogLocation` `ConfigurationLocation` 。</span><span class="sxs-lookup"><span data-stu-id="cb71c-293">After you successfully run DataCollectorMaster.exe in the Collect mode, the following files are created and stored in the folders specified by the  `LogLocation` and  `ConfigurationLocation` parameters.</span></span> 
  
- <span data-ttu-id="cb71c-294">\*\* \<JobName\> _Collect_ \<DateTimeStamp\> \*\* -日志文件包含显示的状态消息。</span><span class="sxs-lookup"><span data-stu-id="cb71c-294">**\<JobName\>_Collect_\<DateTimeStamp\>.log** - The log file contains the status messages that were displayed.</span></span> <span data-ttu-id="cb71c-295">此文件在由参数指定的文件夹中创建 `LogLocation` 。</span><span class="sxs-lookup"><span data-stu-id="cb71c-295">This file is created in the folder specified by the  `LogLocation` parameter.</span></span> 
    
- <span data-ttu-id="cb71c-296">\*\* \<JobName\> _Collect_ \<DateTimeStamp\> \*\* -xml 文件仅包含在收集模式下运行该工具所使用的参数值的相关信息。</span><span class="sxs-lookup"><span data-stu-id="cb71c-296">**\<JobName\>_Collect_\<DateTimeStamp\>.xml** - The XML file only contains information about the parameter values that where used by the tool was run in the Collect mode.</span></span> <span data-ttu-id="cb71c-297">当您运行 DataCollectorMaster.exe 工具以删除 PST 文件时，将使用此文件中的数据;请参阅[第5步](#step-5-delete-the-pst-files-found-on-your-network)。</span><span class="sxs-lookup"><span data-stu-id="cb71c-297">The data in this file is used when you run re-run the DataCollectorMaster.exe tool to delete PST files; see [Step 5](#step-5-delete-the-pst-files-found-on-your-network).</span></span>
    

## <a name="step-4-import-the-pst-files-to-office-365"></a><span data-ttu-id="cb71c-298">步骤4：将 PST 文件导入到 Office 365</span><span class="sxs-lookup"><span data-stu-id="cb71c-298">Step 4: Import the PST files to Office 365</span></span>

<span data-ttu-id="cb71c-299">在您收集了在第1步中找到的 PST 文件之后，下一步是将其导入到 Office 365 中的邮箱。</span><span class="sxs-lookup"><span data-stu-id="cb71c-299">After you've collected the PST files found in Step 1, the next step is to import them to mailboxes in Office 365.</span></span> <span data-ttu-id="cb71c-300">作为部件或导入过程，您必须创建一个 CSV 映射文件，其中包含要导入的每个 PST 文件的行。</span><span class="sxs-lookup"><span data-stu-id="cb71c-300">As part or the import process, you'll have to create a CSV mapping file that contains a row of each PST file that you want import.</span></span> <span data-ttu-id="cb71c-301">每行中的信息指定 PST 文件的名称、用户的电子邮件地址以及是否要将 PST 文件导入到用户的主邮箱或存档邮箱。</span><span class="sxs-lookup"><span data-stu-id="cb71c-301">Information in each row specifies the name of the PST file, the user's email address, and whether you want to import the PST file to the user's primary or archive mailbox.</span></span> <span data-ttu-id="cb71c-302">使用**JobName \> _Find_ \<DateTimeStamp.csv**文件（在步骤中创建）1中的信息来帮助您创建 CSV 映射文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-302">Use the information in the **JobName\>_Find_\<DateTimeStamp.csv** file (created in Step) 1 to help you create the CSV mapping file.</span></span> 
  
<span data-ttu-id="cb71c-303">有关将 PST 文件导入到 Office 365 的分步说明，请参阅下列主题之一：</span><span class="sxs-lookup"><span data-stu-id="cb71c-303">For step-by-step instructions to import PST files to Office 365, see one of the following topics:</span></span>
  
- [<span data-ttu-id="cb71c-304">使用网络上载将 PST 文件导入到 Office 365</span><span class="sxs-lookup"><span data-stu-id="cb71c-304">Use network upload to import PST files to Office 365</span></span>](use-network-upload-to-import-pst-files.md)
    
- [<span data-ttu-id="cb71c-305">使用驱动器传送将 PST 文件导入 Office 365</span><span class="sxs-lookup"><span data-stu-id="cb71c-305">Use drive shipping to import PST files to Office 365</span></span>](use-drive-shipping-to-import-pst-files-to-office-365.md)
    

## <a name="step-5-delete-the-pst-files-found-on-your-network"></a><span data-ttu-id="cb71c-306">步骤5：删除在网络中找到的 PST 文件</span><span class="sxs-lookup"><span data-stu-id="cb71c-306">Step 5: Delete the PST files found on your network</span></span>

<span data-ttu-id="cb71c-307">在 Office 365 中已将您找到和收集的 PST 文件导入到 Exchange Online 邮箱后，您可以使用 PST 集合工具从第1步中找到的原始源位置删除 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-307">After the PST files that you found and collected have been imported to Exchange Online mailboxes in Office 365, you can use the PST Collection tool to delete the PST files from the original source locations where they were found in Step 1.</span></span> 
  
1. <span data-ttu-id="cb71c-308">在您的本地计算机上打开命令提示符（以管理员身份运行）。</span><span class="sxs-lookup"><span data-stu-id="cb71c-308">Open a Command Prompt (run as administrator) on your local computer.</span></span>
    
2. <span data-ttu-id="cb71c-309">转到您在其中下载了 PST 集合工具的目录。</span><span class="sxs-lookup"><span data-stu-id="cb71c-309">Go to the directory where you downloaded the PST Collection tool to.</span></span>
    
3. <span data-ttu-id="cb71c-310">运行以下命令以删除 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-310">Run the following command to delete the PST files.</span></span>

    ```powershell
    DataCollectorMaster.exe -DataSource Pst -Mode Delete -JobName <Name of job from Step 1> -ConfigurationLocation <Location of configuration files from Step 1> -CopyLocation <Location to copy PST files to>
    ```

    <span data-ttu-id="cb71c-311">下表介绍了运行 DataCollectorMaster.exe 命令以删除 PST 文件时的参数及其所需的值。</span><span class="sxs-lookup"><span data-stu-id="cb71c-311">The following table describes the parameters and their required values when you run the DataCollectorMaster.exe command to delete PST files.</span></span> 
    
    |<span data-ttu-id="cb71c-312">参数 \* \* \* \*</span><span class="sxs-lookup"><span data-stu-id="cb71c-312">\*\*\*\*Parameter\*\*\*\*</span></span>|<span data-ttu-id="cb71c-313">\*\*\*\*说明\*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="cb71c-313">\*\*\*\*Description\*\*\*\*</span></span>|<span data-ttu-id="cb71c-314">示例 \* \* \* \*</span><span class="sxs-lookup"><span data-stu-id="cb71c-314">\*\*\*\*Examples\*\*\*\*</span></span>|
    |:-----|:-----|:-----|
    | `DataSource` <br/> |<span data-ttu-id="cb71c-315">指定要搜索的数据的类型。</span><span class="sxs-lookup"><span data-stu-id="cb71c-315">Specifies the type of data to search for.</span></span> <span data-ttu-id="cb71c-316">目前，您可以使用 "PST 集合" 工具搜索 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-316">Currently, you can use the PST Collection tool to search for PST files.</span></span> ![定位](../media/b078d05c-3aee-4b9f-8805-6a8a9d8970ee.png)           <br/> | `-DataSource Pst` <br/> |
    | `Mode` <br/> |<span data-ttu-id="cb71c-318">指定工具将执行的操作的类型。</span><span class="sxs-lookup"><span data-stu-id="cb71c-318">Specifies the type of operation that the tool will perform.</span></span> <span data-ttu-id="cb71c-319">使用此值 `Delete` 可以删除在 "查找" 模式下运行到该工具时找到的 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-319">Use the value  `Delete` to delete that PST files that were found when you ran to the tool in the Find mode.</span></span>  <br/> | `-Mode Delete` <br/> |
    | `JobName` <br/> |<span data-ttu-id="cb71c-320">指定现有 PST 集合作业的名称。</span><span class="sxs-lookup"><span data-stu-id="cb71c-320">Specifies the name of an existing PST Collection job.</span></span> <span data-ttu-id="cb71c-321">您必须使用在 "查找" 模式下运行该工具时使用的相同作业名称，以及步骤1和步骤3中的收集模式。</span><span class="sxs-lookup"><span data-stu-id="cb71c-321">You have to use this same job name that you used when you ran the tool in the Find mode and the Collect mode in Step 1 and Step 3.</span></span> <span data-ttu-id="cb71c-322">此外，还会将此作业名称添加到在删除模式下运行该工具时创建的日志文件的名称。</span><span class="sxs-lookup"><span data-stu-id="cb71c-322">This job name is also added to the name of the log file that is created when you run the tool in the Delete mode.</span></span>  <br/> | `-JobName PstSearch1` <br/> |
    | `ConfigurationLocation` <br/> |<span data-ttu-id="cb71c-323">指定包含在收集模式下运行该工具时创建的 .xml 配置文件的文件夹。</span><span class="sxs-lookup"><span data-stu-id="cb71c-323">Specifies the folder that contains the .xml configuration file that was created when you ran the tool in the Collect mode.</span></span> <span data-ttu-id="cb71c-324">使用您在步骤3中用于此参数的相同值。</span><span class="sxs-lookup"><span data-stu-id="cb71c-324">Use the same value that you used for this parameter in Step 3.</span></span>  <br/> | `-ConfigurationLocation "c:\users\admin\ desktop\PSTCollection\Configuration"` <br/> |
    | `LogLocation` <br/> |<span data-ttu-id="cb71c-325">指定要将删除模式的日志文件复制到的文件夹。</span><span class="sxs-lookup"><span data-stu-id="cb71c-325">Specifies the folder that the log file for the Delete mode will be copied to.</span></span> <span data-ttu-id="cb71c-326">这是一个可选参数。</span><span class="sxs-lookup"><span data-stu-id="cb71c-326">This is an optional parameter.</span></span> <span data-ttu-id="cb71c-327">如果不包含此文件，则会将日志文件复制到您在其中下载 PST 集合工具的文件夹。</span><span class="sxs-lookup"><span data-stu-id="cb71c-327">If you don't include it, the log file is copied to the folder where you downloaded the PST Collection tool to.</span></span> <span data-ttu-id="cb71c-328">考虑在第1步和第3步中的查找和收集模式下运行该工具时使用的相同日志位置，以便将所有日志文件保存在同一文件夹中。</span><span class="sxs-lookup"><span data-stu-id="cb71c-328">Consider using the same log location that you used when you ran the tool in the Find and Collect modes in Step 1 and Step 3 so that all the log files are saved in the same folder.</span></span>  <br/> | `-LogLocation "c:\users\admin\desktop\PSTCollection"` <br/> |
    | `ForceRestart` <br/> |<span data-ttu-id="cb71c-329">此可选开关允许您在删除模式下为现有的 PST 集合作业重新运行该工具。</span><span class="sxs-lookup"><span data-stu-id="cb71c-329">This optional switch lets you re-run the tool in the Delete mode for an existing PST Collection job.</span></span> <span data-ttu-id="cb71c-330">如果您之前在删除模式下运行该工具，但随后在查找模式下再次运行该工具 `ForceRestart` 以重新扫描 PST 文件的位置，则可以使用此开关在删除模式下重新运行该工具，并删除在重新扫描位置时找到的 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-330">If you previously ran the tool in the Delete mode, but then ran the tool again in the Find mode with the  `ForceRestart` switch to re-scan locations for PST files, you can use this switch to re-run the tool in Delete mode and delete the PST files there were found when your re-scanned the locations.</span></span> <span data-ttu-id="cb71c-331">`ForceRestart`在删除模式下使用切换时，该工具将忽略任何以前的删除操作，并再次尝试删除 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-331">When using the  `ForceRestart` switch in Delete mode, the tool ignores any previous Delete operations and attempts to delete the PST files again.</span></span>  <br/> | `-ForceRestart` <br/> 

    <span data-ttu-id="cb71c-332">下面的示例展示了使用每个参数的实际值的 DataCollectorMaster.exe 工具的语法：</span><span class="sxs-lookup"><span data-stu-id="cb71c-332">Here's an example of the syntax for the DataCollectorMaster.exe tool using actual values for each parameter:</span></span>
    
    ```powershell
    DataCollectorMaster.exe -DataSource Pst -Mode Delete -JobName PstSearch1 -ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration" -LogLocation "c:\users\admin\desktop\PSTCollection"
    ```

    <span data-ttu-id="cb71c-333">运行命令后，将显示详细的状态消息，显示删除在步骤1中找到并在步骤3中收集的 PST 文件的进度。</span><span class="sxs-lookup"><span data-stu-id="cb71c-333">After you run the command, detailed status messages are displayed that show the progress of deleting the PST files that were found in Step 1 and collected in Step 3.</span></span> <span data-ttu-id="cb71c-334">一段时间后，最终状态消息将显示是否存在任何错误以及日志复制到的位置。</span><span class="sxs-lookup"><span data-stu-id="cb71c-334">After a while, a final status message shows if there were any errors and the location that the log is copied to.</span></span> <span data-ttu-id="cb71c-335">将相同的状态邮件复制到 .log 文件。</span><span class="sxs-lookup"><span data-stu-id="cb71c-335">The same status messages are copied to the .log file.</span></span>
    
### <a name="results-of-running-datacollectormasterexe-in-the-delete-mode"></a><span data-ttu-id="cb71c-336">在删除模式下运行 DataCollectorMaster.exe 的结果</span><span class="sxs-lookup"><span data-stu-id="cb71c-336">Results of running DataCollectorMaster.exe in the Delete mode</span></span>

<span data-ttu-id="cb71c-337">在删除模式下成功运行 DataCollectorMaster.exe 后，将创建以下文件并将其存储在由和参数指定的文件夹中 `LogLocation` `ConfigurationLocation` 。</span><span class="sxs-lookup"><span data-stu-id="cb71c-337">After you successfully run DataCollectorMaster.exe in the Delete mode, the following files are created and stored in the folder specified by the  `LogLocation` and  `ConfigurationLocation` parameters.</span></span> 
  
- <span data-ttu-id="cb71c-338">\*\* \<JobName\> _Delete_ \<DateTimeStamp\> \*\* -日志文件包含显示的状态消息。</span><span class="sxs-lookup"><span data-stu-id="cb71c-338">**\<JobName\>_Delete_\<DateTimeStamp\>.log** - The log file contains the status messages that were displayed.</span></span> <span data-ttu-id="cb71c-339">此文件在由参数指定的文件夹中创建 `LogLocation` 。</span><span class="sxs-lookup"><span data-stu-id="cb71c-339">This file is created in the folder specified by the  `LogLocation` parameter.</span></span> 
    
- <span data-ttu-id="cb71c-340">\*\* \<JobName\> _Delete_ \<DateTimeStamp\> \*\* .xml-xml 文件仅包含在删除模式下运行工具所使用的参数值的相关信息。</span><span class="sxs-lookup"><span data-stu-id="cb71c-340">**\<JobName\>_Delete_\<DateTimeStamp\>.xml** - The XML file only contains information about the parameter values that where used by the tool was run in the Delete mode.</span></span> <span data-ttu-id="cb71c-341">它还列出了每个已删除的 PST 文件的名称和文件路径。</span><span class="sxs-lookup"><span data-stu-id="cb71c-341">It also lists the name and file path of each PST file that was deleted.</span></span> <span data-ttu-id="cb71c-342">此文件在由参数指定的文件夹中创建 `ConfigurationLocation` 。</span><span class="sxs-lookup"><span data-stu-id="cb71c-342">This file is created in the folder specified by the  `ConfigurationLocation` parameter.</span></span> 
