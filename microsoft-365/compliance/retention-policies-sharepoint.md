---
title: 了解用于 SharePoint 和 OneDrive 的保留
f1.keywords:
- NOCSH
ms.author: cabailey
author: cabailey
manager: laurawi
ms.date: ''
audience: Admin
ms.topic: conceptual
ms.service: O365-seccomp
localization_priority: Priority
ms.collection:
- M365-security-compliance
- SPO_Content
search.appverid:
- MOE150
- MET150
description: 了解用于 SharePoint 和 OneDrive 的保留的工作原理。
ms.openlocfilehash: f19f452a01c093d08dbeed38a34756dcaf7a4e95
ms.sourcegitcommit: e8b9a4f18330bc09f665aa941f1286436057eb28
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/14/2020
ms.locfileid: "45127399"
---
# <a name="learn-about-retention-for-sharepoint-and-onedrive"></a>了解用于 SharePoint 和 OneDrive 的保留

>*[Microsoft 365 安全性与合规性许可指南](https://aka.ms/ComplianceSD)。*

本文中的信息是对[了解保留](retention.md)的补充，因为它包含特定于 SharePoint 和 OneDrive 的信息。

## <a name="how-retention-works-for-sharepoint-and-onedrive"></a>用于 SharePoint 和 OneDrive 的保留的工作原理

为了支持保留，SharePoint 和 OneDrive 创建了保留库（如果还没有的话）。 你可在网站集的最顶级网站中的“**网站内容**”上查看此库。 大多数用户都无法查看保留库，因为此库仅对网站集管理员可见。
  
如果有人尝试更改或删除遵循保留设置的文档，则会检查自应用保留设置以来是否更改了内容。 如果这是自应用保留设置以来的首次更改，则会将内容复制到保留库中，用户可以在其中更改或删除原始内容。 可以将网站集中的任何内容复制到保留库中，而不管保留设置如何。
  
计时器作业会定期清理保留库。 此作业将保留库中的所有内容与保留设置对此内容使用的所有查询进行比较。 早于其配置的保留期的内容将从保存保留库和原始位置（如果仍在该位置）中删除。 此计时器作业每 7 天运行一次，这意味着删除内容可能需要长达 7 天的时间。
  
此行为适用于在应用保留设置时就存在的内容。 另外，对于保留策略，在策略中添加网站集后在网站集中创建或添加的所有新内容都会在删除后保留。 然而，新内容不会在第一次编辑时就复制到保留库，只有在删除时才会这样做。 若要保留文件的所有版本，必须启用[版本控制](#how-retention-works-with-document-versions-in-a-site-collection)。
  
如果用户尝试删除受保留策略约束的库、列表、文件夹或网站，将收到错误提示。 如果用户首次移动或删除文件夹中受该策略约束的任何文件，可删除一个文件夹。 另外，保留库是在此阶段创建的，而不是在创建保留策略或应用保留标签时创建的。 也就是说，若要测试保留，必须先编辑或删除网站中遵循保留策略或已应用保留标签的文档，然后转到保留库来查看保留的副本。
  
在向 OneDrive 帐户或 SharePoint 网站中的内容分配保留设置后，内容路径取决于保留设置是“保留后删除”、“仅保留”还是“仅删除”。

如果保留设置是“保留后删除”：

![SharePoint 和 OneDrive 中的内容生命周期关系图](../media/Retention_Diagram_of_retention_flow_in_sites.png)
  
1. **如果内容在保持期内遭修改或删除**：则会在保留库中创建在分配保留策略时存在的原始内容的副本。 计时器作业可识别保留期限已过期的项目。 这些项目会被移到第二阶段回收站中，并在 93 天后永久删除。 第二阶段回收站对最终用户不可见（仅第一阶段回收站可见），但网站集管理员可以在其中查看和还原内容。

    > [!NOTE]
    > 为了防止意外的数据丢失，不再从保留库中永久删除内容。 相反，只从回收站中永久删除内容，因此保留库中的所有内容现在都要移到第二阶段回收站。
    
2. **如果在保留期限内未修改或删除内容**，则计时器作业会在保留期限结束后将此内容移到第一阶段回收站。 如果用户在第一阶段回收站中删除了该内容或清空了此回收站（也称为清除），则文档会被移到第二阶段回收站。 在第一阶段和第二阶段回收站中的停留时间都计入 93 天保持期。93 天后，无论文档是位于第一阶段回收站中，还是位于第二阶段回收站中，都会从驻留位置永久删除。 回收站未被编入索引，因此无法进行搜索。 因此，电子数据展示搜索无法找到任何要在其上保留的回收站内容。

如果保留设置为“仅保留”或“仅删除”，内容路径在“保留后删除”策略的基础上有所变化：

### <a name="content-paths-for-retain-only-retention-settings"></a>“仅保留”保留设置的内容路径

1. **如果有人在保持期内修改或删除内容**：则会在保留库中创建原始文档的副本，并保留到保持期结束，然后保留库中的副本会移到第二阶段回收站中，并在 93 天后永久删除。

2. **如果内容在保持期内未遭修改或删除**：保持期前后无变化；文档仍保留在它的原始位置上。

### <a name="content-paths-for-delete-only-retention-settings"></a>“仅删除”保留设置的内容路径

1. **如果有人在配置的期限内删除内容**：文档会移到第一阶段回收站中。 如果用户从此回收站中删除文档或清空此回收站，文档就会移到第二阶段回收站中。 在第一阶段和第二阶段回收站中的停留时间都计入 93 天保持期。93 天后，无论文档是位于第一阶段回收站中，还是位于第二阶段回收站中，都会从驻留位置永久删除。 如果有人在配置的期限内修改内容，内容就会在配置的期限到期后遵循相同的删除路径。

2. **如果内容在配置的期限内未遭删除**：在保留策略中配置的期限结束时，文档会移到第一阶段回收站中。 如果用户从此回收站中删除文档或清空此回收站（亦称为“清除”），文档就会移到第二阶段回收站中。 在第一阶段和第二阶段回收站中的停留时间都计入 93 天保持期。93 天后，无论文档是位于第一阶段回收站中，还是位于第二阶段回收站中，都会从驻留位置永久删除。 回收站未被编入索引，因此无法进行搜索。 因此，电子数据展示搜索无法找到任何要在其上保留的回收站内容。

## <a name="how-retention-works-with-document-versions-in-a-site-collection"></a>用于网站集中文档版本的保留的工作原理

版本控制是 SharePoint 和 OneDrive 中所有文档库的一项功能。 默认情况下，版本控制至少保留 500 个主要版本，但可以提高此限制。 有关详细信息，请参阅[为列表或库启用和配置版本控制](https://support.office.com/article/1555d642-23ee-446a-990a-bcab618c7a37)。
  
“仅保留”设置保留 SharePoint 网站集或 OneDrive 帐户中文档的所有版本。 当遵循保留或“仅保留”保留设置的文档被首次编辑时，原始文档的一个版本就会复制到保留库中。 当遵循保留或“仅保留”保留设置的文档被删除时，如果版本控制已启用，所有版本都会复制到保留库中。 在保留库中，文档的每个版本都以单独项的形式存在，并且有自己的保留期：
  
- 如果保留期是以内容创建时间为依据，那么文档的每个版本的到期日期都与原始文档相同。 原始文档及其各版本全都在同一时间到期。

- 如果保留期是以内容的上次修改时间为依据，那么文档的每个版本都有自己的到期日期，具体视修改原始文档来创建相应版本的时间而定。 原始文档及其各版本的到期互不影响。

> [!NOTE]
> 电子数据展示工具无法用于搜索 SharePoint 和 OneDrive 文档的保留版本。

## <a name="when-a-user-leaves-the-organization"></a>如果某用户离开组织

**SharePoint**：

如果某用户离开组织，此用户创建的任何内容都不会受到影响，因为 SharePoint 被视为协作环境，与用户的邮箱或 OneDrive 帐户不同。

**OneDrive**：

如果某用户离开组织，任何受保留策略约束或包含保留标签的文件都会在策略或标签有效期间保留。 在此期间，所有共享访问继续有效。 在保留期到期后，内容会移到网站集回收站，且不可供除管理员之外的其他任何人访问。如果文档被保留标签标记为记录，那么文档在保留期到期前不会被删除，到期后将被永久删除。

## <a name="configuration-guidance"></a>配置指南

如果你已准备好在 Microsoft 365 中配置保留，请参阅[开始使用保留策略和保留标签](get-started-with-retention.md)。
