---
title: 了解用于 SharePoint 和 OneDrive 的保留
f1.keywords:
- NOCSH
ms.author: cabailey
author: cabailey
manager: laurawi
ms.date: ''
audience: Admin
ms.topic: conceptual
ms.service: O365-seccomp
localization_priority: Priority
ms.collection:
- M365-security-compliance
- SPO_Content
search.appverid:
- MOE150
- MET150
description: 了解用于 SharePoint 和 OneDrive 的保留的工作原理。
ms.openlocfilehash: 3c1b2564b0ba9d96d22ab9d3b78da500b54363e2
ms.sourcegitcommit: 19515d787246d38c4e0da579a767ce67b9dbc2bc
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/31/2020
ms.locfileid: "47315785"
---
# <a name="learn-about-retention-for-sharepoint-and-onedrive"></a><span data-ttu-id="f347d-103">了解用于 SharePoint 和 OneDrive 的保留</span><span class="sxs-lookup"><span data-stu-id="f347d-103">Learn about retention for SharePoint and OneDrive</span></span>

><span data-ttu-id="f347d-104">*[Microsoft 365 安全性与合规性许可指南](https://aka.ms/ComplianceSD)。*</span><span class="sxs-lookup"><span data-stu-id="f347d-104">*[Microsoft 365 licensing guidance for security & compliance](https://aka.ms/ComplianceSD).*</span></span>

<span data-ttu-id="f347d-105">本文中的信息是对[了解保留](retention.md)的补充，因为它包含特定于 SharePoint 和 OneDrive 的信息。</span><span class="sxs-lookup"><span data-stu-id="f347d-105">The information in this article supplements [Learn about retention](retention.md) because it has information that's specific to SharePoint and OneDrive.</span></span>

## <a name="how-retention-works-for-sharepoint-and-onedrive"></a><span data-ttu-id="f347d-106">用于 SharePoint 和 OneDrive 的保留的工作原理</span><span class="sxs-lookup"><span data-stu-id="f347d-106">How retention works for SharePoint and OneDrive</span></span>

<span data-ttu-id="f347d-107">为了支持保留，SharePoint 和 OneDrive 创建了保留库（如果还没有的话）。</span><span class="sxs-lookup"><span data-stu-id="f347d-107">To support retention, SharePoint and OneDrive creates a Preservation Hold library if one doesn't exist.</span></span> <span data-ttu-id="f347d-108">你可在网站集的最顶级网站中的“**网站内容**”上查看此库。</span><span class="sxs-lookup"><span data-stu-id="f347d-108">You can view this library on the **Site contents** page in the top-level site of the site collection.</span></span> <span data-ttu-id="f347d-109">大多数用户都无法查看保留库，因为此库仅对网站集管理员可见。</span><span class="sxs-lookup"><span data-stu-id="f347d-109">Most users can't view the Preservation Hold library because it's visible only to site collection administrators.</span></span>
  
<span data-ttu-id="f347d-110">如果有人尝试更改或删除遵循保留设置的文档，则会检查自应用保留设置以来是否更改了内容。</span><span class="sxs-lookup"><span data-stu-id="f347d-110">If somebody attempts to change or delete a document that's subject to retention settings, a check is made whether the content's been changed since the retention settings were applied.</span></span> <span data-ttu-id="f347d-111">如果这是自应用保留设置以来的首次更改，则会将内容复制到保留库中，用户可以在其中更改或删除原始内容。</span><span class="sxs-lookup"><span data-stu-id="f347d-111">If this is the first change since the retention settings were applied, the content is copied to the Preservation Hold library, which allows the person to change or delete the original content.</span></span> <span data-ttu-id="f347d-112">可以将网站集中的任何内容复制到保留库中，而不管保留设置如何。</span><span class="sxs-lookup"><span data-stu-id="f347d-112">Any content in a site collection can be copied to the Preservation Hold library, independently from retention settings.</span></span>
  
<span data-ttu-id="f347d-113">计时器作业会定期清理保留库。</span><span class="sxs-lookup"><span data-stu-id="f347d-113">A timer job periodically cleans up the Preservation Hold library.</span></span> <span data-ttu-id="f347d-114">此作业将保留库中的所有内容与保留设置对此内容使用的所有查询进行比较。</span><span class="sxs-lookup"><span data-stu-id="f347d-114">This job compares all content in the Preservation Hold library to all queries used by the retention settings for that content.</span></span> <span data-ttu-id="f347d-115">早于其配置的保留期的内容将从保存保留库和原始位置（如果仍在该位置）中删除。</span><span class="sxs-lookup"><span data-stu-id="f347d-115">Content that is older than their configured retention period is deleted from the Preservation Hold library, and the original location if it is still there.</span></span> <span data-ttu-id="f347d-116">此计时器作业每 7 天运行一次，这意味着删除内容可能需要长达 7 天的时间。</span><span class="sxs-lookup"><span data-stu-id="f347d-116">This timer job runs every seven days, which means that it can take up to seven days for content to be deleted.</span></span>
  
<span data-ttu-id="f347d-117">此行为适用于在应用保留设置时就存在的内容。</span><span class="sxs-lookup"><span data-stu-id="f347d-117">This behavior applies to content that exists when the retention settings were applied.</span></span> <span data-ttu-id="f347d-118">另外，对于保留策略，在策略中添加网站集后在网站集中创建或添加的所有新内容都会在删除后保留。</span><span class="sxs-lookup"><span data-stu-id="f347d-118">In addition, for retention policies, any new content that's created or added to the site collection after it was included in the policy will be retained after deletion.</span></span> <span data-ttu-id="f347d-119">然而，新内容不会在第一次编辑时就复制到保留库，只有在删除时才会这样做。</span><span class="sxs-lookup"><span data-stu-id="f347d-119">However, new content isn't copied to the Preservation Hold library the first time it's edited, only when it's deleted.</span></span> <span data-ttu-id="f347d-120">若要保留文件的所有版本，必须启用[版本控制](#how-retention-works-with-document-versions-in-a-site-collection)。</span><span class="sxs-lookup"><span data-stu-id="f347d-120">To retain all versions of a file, you must turn on [versioning](#how-retention-works-with-document-versions-in-a-site-collection).</span></span>
  
<span data-ttu-id="f347d-121">如果用户尝试删除受保留策略约束的库、列表、文件夹或网站，将收到错误提示。</span><span class="sxs-lookup"><span data-stu-id="f347d-121">A user receives an error if they try to delete a library, list, folder, or site that's subject to a retention policy.</span></span> <span data-ttu-id="f347d-122">如果用户首次移动或删除文件夹中受该策略约束的任何文件，可删除一个文件夹。</span><span class="sxs-lookup"><span data-stu-id="f347d-122">A user can delete a folder if they first move or delete any files in the folder that are subject to the policy.</span></span> <span data-ttu-id="f347d-123">另外，保留库是在此阶段创建的，而不是在创建保留策略或应用保留标签时创建的。</span><span class="sxs-lookup"><span data-stu-id="f347d-123">Also, the Preservation Hold library is created at this stage, and not when you create a retention policy or apply a retention label.</span></span> <span data-ttu-id="f347d-124">也就是说，若要测试保留，必须先编辑或删除网站中遵循保留策略或已应用保留标签的文档，然后转到保留库来查看保留的副本。</span><span class="sxs-lookup"><span data-stu-id="f347d-124">This means that to test retention, you must first edit or delete a document in a site that's subject to a retention policy or that has a retention label applied, and then browse to the Preservation Hold library to view the retained copy.</span></span>
  
<span data-ttu-id="f347d-125">在向 OneDrive 帐户或 SharePoint 网站中的内容分配保留设置后，内容路径取决于保留设置是“保留后删除”、“仅保留”还是“仅删除”。</span><span class="sxs-lookup"><span data-stu-id="f347d-125">After retention settings are assigned to content in a OneDrive account or SharePoint site, the paths the content takes depend on whether the retention settings are to retain and delete, to retain only, or delete only.</span></span>

<span data-ttu-id="f347d-126">如果保留设置是“保留后删除”：</span><span class="sxs-lookup"><span data-stu-id="f347d-126">When the retention setting are to retain and delete:</span></span>

![SharePoint 和 OneDrive 中的内容生命周期关系图](../media/Retention_Diagram_of_retention_flow_in_sites.png)
  
1. <span data-ttu-id="f347d-128">**如果内容在保持期内遭修改或删除**：则会在保留库中创建在分配保留策略时存在的原始内容的副本。</span><span class="sxs-lookup"><span data-stu-id="f347d-128">**If the content is modified or deleted** during the retention period, a copy of the original content as it existed when the retention policy was assigned is created in the Preservation Hold library.</span></span> <span data-ttu-id="f347d-129">计时器作业可识别保留期限已过期的项目。</span><span class="sxs-lookup"><span data-stu-id="f347d-129">There, the timer job identifies items whose retention period has expired.</span></span> <span data-ttu-id="f347d-130">这些项目会被移到第二阶段回收站中，并在 93 天后永久删除。</span><span class="sxs-lookup"><span data-stu-id="f347d-130">Those items are moved to the second-stage Recycle Bin, where they're permanently deleted at the end of 93 days.</span></span> <span data-ttu-id="f347d-131">第二阶段回收站对最终用户不可见（仅第一阶段回收站可见），但网站集管理员可以在其中查看和还原内容。</span><span class="sxs-lookup"><span data-stu-id="f347d-131">The second-stage Recycle Bin is not visible to end users (only the first-stage Recycle Bin is), but site collection admins can view and restore content from there.</span></span>

    > [!NOTE]
    > <span data-ttu-id="f347d-132">为了防止意外的数据丢失，不再从保留库中永久删除内容。</span><span class="sxs-lookup"><span data-stu-id="f347d-132">To help prevent inadvertent data loss, we no longer permanently delete content from the Preservation Hold library.</span></span> <span data-ttu-id="f347d-133">相反，只从回收站中永久删除内容，因此保留库中的所有内容现在都要移到第二阶段回收站。</span><span class="sxs-lookup"><span data-stu-id="f347d-133">Instead, we permanently delete content only from the Recycle Bin, so all content from the Preservation Hold library now goes through the second-stage Recycle Bin.</span></span>
    
2. <span data-ttu-id="f347d-134">**如果在保留期限内未修改或删除内容**，则计时器作业会在保留期限结束后将此内容移到第一阶段回收站。</span><span class="sxs-lookup"><span data-stu-id="f347d-134">**If the content is not modified or deleted** during the retention period, the timer job moves this content to the first-stage Recycle Bin at the end of the retention period.</span></span> <span data-ttu-id="f347d-135">如果用户在第一阶段回收站中删除了该内容或清空了此回收站（也称为清除），则文档会被移到第二阶段回收站。</span><span class="sxs-lookup"><span data-stu-id="f347d-135">If a user deletes the content from there or empties this Recycle Bin (also known as purging), the document is moved to the second-stage Recycle Bin.</span></span> <span data-ttu-id="f347d-136">在第一阶段和第二阶段回收站中的停留时间都计入 93 天保持期。93 天后，无论文档是位于第一阶段回收站中，还是位于第二阶段回收站中，都会从驻留位置永久删除。</span><span class="sxs-lookup"><span data-stu-id="f347d-136">A 93-day retention period spans both the first- and second-stage recycle bins. At the end of 93 days, the document is permanently deleted from wherever it resides, in either the first-stage or second-stage Recycle Bin.</span></span> <span data-ttu-id="f347d-137">回收站未被编入索引，因此无法进行搜索。</span><span class="sxs-lookup"><span data-stu-id="f347d-137">The Recycle Bin is not indexed and therefore unavailable for searching.</span></span> <span data-ttu-id="f347d-138">因此，电子数据展示搜索无法找到任何要在其上保留的回收站内容。</span><span class="sxs-lookup"><span data-stu-id="f347d-138">As a result, an eDiscovery search can't find any Recycle Bin content on which to place a hold.</span></span>

<span data-ttu-id="f347d-139">如果保留设置为“仅保留”或“仅删除”，内容路径在“保留后删除”策略的基础上有所变化：</span><span class="sxs-lookup"><span data-stu-id="f347d-139">When the retention settings are retain-only, or delete-only, the contents paths are variations of retain and delete:</span></span>

### <a name="content-paths-for-retain-only-retention-settings"></a><span data-ttu-id="f347d-140">“仅保留”保留设置的内容路径</span><span class="sxs-lookup"><span data-stu-id="f347d-140">Content paths for retain-only retention settings</span></span>

1. <span data-ttu-id="f347d-141">**如果有人在保持期内修改或删除内容**：则会在保留库中创建原始文档的副本，并保留到保持期结束，然后保留库中的副本会移到第二阶段回收站中，并在 93 天后永久删除。</span><span class="sxs-lookup"><span data-stu-id="f347d-141">**If the content is modified or deleted** during the retention period: A copy of the original document is created in the Preservation Hold library and retained until the end of the retention period, when the copy in the Preservation Hold library is moved to the second-stage Recycle Bin and is permanently deleted after 93 days.</span></span>

2. <span data-ttu-id="f347d-142">**如果内容在保持期内未遭修改或删除**：保持期前后无变化；文档仍保留在它的原始位置上。</span><span class="sxs-lookup"><span data-stu-id="f347d-142">**If the content is not modified or deleted** during the retention period: Nothing happens before and after the retention period; the document remains in its original location.</span></span>

### <a name="content-paths-for-delete-only-retention-settings"></a><span data-ttu-id="f347d-143">“仅删除”保留设置的内容路径</span><span class="sxs-lookup"><span data-stu-id="f347d-143">Content paths for delete-only retention settings</span></span>

1. <span data-ttu-id="f347d-144">**如果有人在配置的期限内删除内容**：文档会移到第一阶段回收站中。</span><span class="sxs-lookup"><span data-stu-id="f347d-144">**If the content is deleted** during the configured period: The document is moved to first-stage Recycle Bin.</span></span> <span data-ttu-id="f347d-145">如果用户从此回收站中删除文档或清空此回收站，文档就会移到第二阶段回收站中。</span><span class="sxs-lookup"><span data-stu-id="f347d-145">If a user deletes the document from there or empties this Recycle Bin, the document is moved to the second-stage Recycle Bin.</span></span> <span data-ttu-id="f347d-146">在第一阶段和第二阶段回收站中的停留时间都计入 93 天保持期。93 天后，无论文档是位于第一阶段回收站中，还是位于第二阶段回收站中，都会从驻留位置永久删除。</span><span class="sxs-lookup"><span data-stu-id="f347d-146">A 93-day retention period spans both the first-stage and second-stage recycle bins. At the end of 93 days, the document is permanently deleted from wherever it resides, in either the first-stage or second-stage Recycle Bin.</span></span> <span data-ttu-id="f347d-147">如果有人在配置的期限内修改内容，内容就会在配置的期限到期后遵循相同的删除路径。</span><span class="sxs-lookup"><span data-stu-id="f347d-147">If the content is modified during the configured period, it follows the same deletion path after the configured period.</span></span>

2. <span data-ttu-id="f347d-148">**如果内容在配置的期限内未遭删除**：在保留策略中配置的期限结束时，文档会移到第一阶段回收站中。</span><span class="sxs-lookup"><span data-stu-id="f347d-148">**If the content is not deleted** during the configured period: At the end of the configured period in the retention policy, the document is moved to the first-stage Recycle Bin.</span></span> <span data-ttu-id="f347d-149">如果用户从此回收站中删除文档或清空此回收站（亦称为“清除”），文档就会移到第二阶段回收站中。</span><span class="sxs-lookup"><span data-stu-id="f347d-149">If a user deletes the document from there or empties this Recycle Bin (also known as purging), the document is moved to the second-stage Recycle Bin.</span></span> <span data-ttu-id="f347d-150">在第一阶段和第二阶段回收站中的停留时间都计入 93 天保持期。93 天后，无论文档是位于第一阶段回收站中，还是位于第二阶段回收站中，都会从驻留位置永久删除。</span><span class="sxs-lookup"><span data-stu-id="f347d-150">A 93-day retention period spans both the first-stage and second-stage recycle bins. At the end of 93 days, the document is permanently deleted from wherever it resides, in either the first-stage or second-stage Recycle Bin.</span></span> <span data-ttu-id="f347d-151">回收站未被编入索引，因此无法进行搜索。</span><span class="sxs-lookup"><span data-stu-id="f347d-151">The Recycle Bin is not indexed and therefore unavailable for searching.</span></span> <span data-ttu-id="f347d-152">因此，电子数据展示搜索无法找到任何要在其上保留的回收站内容。</span><span class="sxs-lookup"><span data-stu-id="f347d-152">As a result, an eDiscovery search can't find any Recycle Bin content on which to place a hold.</span></span>

## <a name="how-retention-works-with-document-versions-in-a-site-collection"></a><span data-ttu-id="f347d-153">用于网站集中文档版本的保留的工作原理</span><span class="sxs-lookup"><span data-stu-id="f347d-153">How retention works with document versions in a site collection</span></span>

<span data-ttu-id="f347d-154">版本控制是 SharePoint 和 OneDrive 中所有文档库的一项功能。</span><span class="sxs-lookup"><span data-stu-id="f347d-154">Versioning is a feature of all document libraries in SharePoint and OneDrive.</span></span> <span data-ttu-id="f347d-155">默认情况下，版本控制至少保留 500 个主要版本，但可以提高此限制。</span><span class="sxs-lookup"><span data-stu-id="f347d-155">By default, versioning retains a minimum of 500 major versions, though you can increase this limit.</span></span> <span data-ttu-id="f347d-156">有关详细信息，请参阅[为列表或库启用和配置版本控制](https://support.office.com/article/1555d642-23ee-446a-990a-bcab618c7a37)和[版本控制在列表和库中的工作方式](https://support.microsoft.com/office/how-versioning-works-in-lists-and-libraries-0f6cd105-974f-44a4-aadb-43ac5bdfd247)。</span><span class="sxs-lookup"><span data-stu-id="f347d-156">For more information, see [Enable and configure versioning for a list or library](https://support.office.com/article/1555d642-23ee-446a-990a-bcab618c7a37) and [How versioning works in lists and libraries](https://support.microsoft.com/office/how-versioning-works-in-lists-and-libraries-0f6cd105-974f-44a4-aadb-43ac5bdfd247).</span></span>
  
<span data-ttu-id="f347d-157">“仅保留”设置保留 SharePoint 网站集或 OneDrive 帐户中文档的所有版本。</span><span class="sxs-lookup"><span data-stu-id="f347d-157">Retain-only settings retain all versions of a document in a SharePoint site collection or OneDrive account.</span></span> <span data-ttu-id="f347d-158">当遵循保留或“仅保留”保留设置的文档被首次编辑时，原始文档的一个版本就会复制到保留库中。</span><span class="sxs-lookup"><span data-stu-id="f347d-158">When a document that is subject to a hold or retain-only retention settings is edited for the first time, a version of the original document is copied to the Preservation Hold library.</span></span> <span data-ttu-id="f347d-159">当遵循保留或“仅保留”保留设置的文档被删除时，如果版本控制已启用，所有版本都会复制到保留库中。</span><span class="sxs-lookup"><span data-stu-id="f347d-159">When a document that is subject to a hold or retain-only settings is deleted, all versions are copied to the Preservation Hold library if versioning is enabled.</span></span> <span data-ttu-id="f347d-160">在保留库中，文档的每个版本都以单独项的形式存在，并且有自己的保留期：</span><span class="sxs-lookup"><span data-stu-id="f347d-160">Each version of a document in the Preservation Hold library exists as a separate item with its own retention period:</span></span>
  
- <span data-ttu-id="f347d-161">如果保留期是以内容创建时间为依据，那么文档的每个版本的到期日期都与原始文档相同。</span><span class="sxs-lookup"><span data-stu-id="f347d-161">If the retention period is based on when the content was created, each version has the same expiration date as the original document.</span></span> <span data-ttu-id="f347d-162">原始文档及其各版本全都在同一时间到期。</span><span class="sxs-lookup"><span data-stu-id="f347d-162">The original document and its versions all expire at the same time.</span></span>

- <span data-ttu-id="f347d-163">如果保留期是以内容的上次修改时间为依据，那么文档的每个版本都有自己的到期日期，具体视修改原始文档来创建相应版本的时间而定。</span><span class="sxs-lookup"><span data-stu-id="f347d-163">If the retention period is based on when the content was last modified, each version has its own expiration date based on when the original document was modified to create that version.</span></span> <span data-ttu-id="f347d-164">原始文档及其各版本的到期互不影响。</span><span class="sxs-lookup"><span data-stu-id="f347d-164">The original documents and its versions expire independently of each other.</span></span>

> [!NOTE]
> <span data-ttu-id="f347d-165">电子数据展示工具无法用于搜索 SharePoint 和 OneDrive 文档的保留版本。</span><span class="sxs-lookup"><span data-stu-id="f347d-165">The preserved versions of SharePoint and OneDrive documents are not searchable by eDiscovery tools.</span></span>

<span data-ttu-id="f347d-166">对于受保留策略（或法定保留）约束的项目，将忽略文档库的版本控制限制，直到达到文档的保留期限。</span><span class="sxs-lookup"><span data-stu-id="f347d-166">For items that are subject to a retention policies (or a legal hold), the versioning limits for the document library are ignored until the retention period of the document is reached.</span></span> <span data-ttu-id="f347d-167">在这种情况下，不会自动清除旧版本，并且会阻止用户删除版本。</span><span class="sxs-lookup"><span data-stu-id="f347d-167">In this scenario, old versions are not automatically purged and users are prevented from deleting versions.</span></span>

<span data-ttu-id="f347d-168">如果未对网站应用保留策略，保留标签的情况就不是这样。</span><span class="sxs-lookup"><span data-stu-id="f347d-168">That's not the case for retention labels when a retention policy isn't applied to the site.</span></span> <span data-ttu-id="f347d-169">相反，它将遵循版本控制限制，以便自动删除旧版本以容纳新版本，但仍阻止用户删除版本。</span><span class="sxs-lookup"><span data-stu-id="f347d-169">Instead, the versioning limits are honored so that older versions are automatically deleted to accommodate new versions, but users are still prevented from deleting versions.</span></span>

## <a name="when-a-user-leaves-the-organization"></a><span data-ttu-id="f347d-170">如果某用户离开组织</span><span class="sxs-lookup"><span data-stu-id="f347d-170">When a user leaves the organization</span></span>

<span data-ttu-id="f347d-171">**SharePoint**：</span><span class="sxs-lookup"><span data-stu-id="f347d-171">**SharePoint**:</span></span>

<span data-ttu-id="f347d-172">如果某用户离开组织，此用户创建的任何内容都不会受到影响，因为 SharePoint 被视为协作环境，与用户的邮箱或 OneDrive 帐户不同。</span><span class="sxs-lookup"><span data-stu-id="f347d-172">When a user leaves your organization, any content created by that user is not affected because SharePoint is considered a collaborative environment, unlike a user's mailbox or OneDrive account.</span></span>

<span data-ttu-id="f347d-173">**OneDrive**：</span><span class="sxs-lookup"><span data-stu-id="f347d-173">**OneDrive**:</span></span>

<span data-ttu-id="f347d-174">如果某用户离开组织，任何受保留策略约束或包含保留标签的文件都会在策略或标签有效期间保留。</span><span class="sxs-lookup"><span data-stu-id="f347d-174">If a user leaves your organization, any files that are subject to a retention policy or has a retention label will remain for the duration of the policy or label.</span></span> <span data-ttu-id="f347d-175">在此期间，所有共享访问继续有效。</span><span class="sxs-lookup"><span data-stu-id="f347d-175">During that time period, all sharing access continues to work.</span></span> <span data-ttu-id="f347d-176">在保留期到期后，内容会移到网站集回收站，且不可供除管理员之外的其他任何人访问。如果文档被保留标签标记为记录，那么文档在保留期到期前不会被删除，到期后将被永久删除。</span><span class="sxs-lookup"><span data-stu-id="f347d-176">When the retention period expires, content moves into the Site Collection Recycle Bin and is not accessible to anyone except the admin. If a document is marked by a retention label as a record, the document will not be deleted until the retention period is over, after which time the content is permanently deleted.</span></span>

## <a name="configuration-guidance"></a><span data-ttu-id="f347d-177">配置指南</span><span class="sxs-lookup"><span data-stu-id="f347d-177">Configuration guidance</span></span>

<span data-ttu-id="f347d-178">如果你已准备好在 Microsoft 365 中配置保留，请参阅[开始使用保留策略和保留标签](get-started-with-retention.md)。</span><span class="sxs-lookup"><span data-stu-id="f347d-178">If you're ready to configure retention in Microsoft 365, see [Get started with retention policies and retention labels](get-started-with-retention.md).</span></span>
