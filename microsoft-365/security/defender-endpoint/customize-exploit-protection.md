---
title: 自定义漏洞保护
keywords: Exploit Protection， 缓解， 启用， powershell， dep， cfg， emet， aslr
description: 可以使用 Windows 安全应用或 PowerShell 启用或禁用 Exploit Protection 使用的特定缓解。 还可以审核缓解和导出配置。
search.product: eADQiWindows 10XVcnh
ms.prod: m365-security
ms.mktglfcycl: manage
ms.sitesec: library
localization_priority: Normal
audience: ITPro
author: dansimp
ms.author: dansimp
ms.reviewer: ''
manager: dansimp
ms.technology: mde
ms.openlocfilehash: 3337389df045775f8a31417894ee1ecbac9f1ae5
ms.sourcegitcommit: 6e5c00f84b5201422aed094f2697016407df8fc2
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/02/2021
ms.locfileid: "51570956"
---
# <a name="customize-exploit-protection"></a><span data-ttu-id="28376-105">自定义漏洞保护</span><span class="sxs-lookup"><span data-stu-id="28376-105">Customize exploit protection</span></span>

[!INCLUDE [Microsoft 365 Defender rebranding](../../includes/microsoft-defender.md)]


<span data-ttu-id="28376-106">**适用于：**</span><span class="sxs-lookup"><span data-stu-id="28376-106">**Applies to:**</span></span>
- [<span data-ttu-id="28376-107">Microsoft Defender for Endpoint</span><span class="sxs-lookup"><span data-stu-id="28376-107">Microsoft Defender for Endpoint</span></span>](https://go.microsoft.com/fwlink/p/?linkid=2154037)
- [<span data-ttu-id="28376-108">Microsoft 365 Defender</span><span class="sxs-lookup"><span data-stu-id="28376-108">Microsoft 365 Defender</span></span>](https://go.microsoft.com/fwlink/?linkid=2118804)

><span data-ttu-id="28376-109">想要体验适用于终结点的 Defender？</span><span class="sxs-lookup"><span data-stu-id="28376-109">Want to experience Defender for Endpoint?</span></span> [<span data-ttu-id="28376-110">注册免费试用版。</span><span class="sxs-lookup"><span data-stu-id="28376-110">Sign up for a free trial.</span></span>](https://www.microsoft.com/microsoft-365/windows/microsoft-defender-atp?ocid=docs-wdatp-assignaccess-abovefoldlink)


<span data-ttu-id="28376-111">Exploit Protection 会自动在操作系统进程和个别应用上应用大量攻击缓解技术。</span><span class="sxs-lookup"><span data-stu-id="28376-111">Exploit protection automatically applies a number of exploit mitigation techniques on both the operating system processes and on individual apps.</span></span>

<span data-ttu-id="28376-112">在单个设备上使用 Windows 安全应用配置这些设置。</span><span class="sxs-lookup"><span data-stu-id="28376-112">Configure these settings using the Windows Security app on an individual device.</span></span> <span data-ttu-id="28376-113">然后，将配置导出为 XML 文件，以便你可以部署到其他设备。</span><span class="sxs-lookup"><span data-stu-id="28376-113">Then, export the configuration as an XML file so you can deploy to other devices.</span></span> <span data-ttu-id="28376-114">使用组策略将 XML 文件一次分发到多个设备。</span><span class="sxs-lookup"><span data-stu-id="28376-114">Use Group Policy to distribute the XML file to multiple devices at once.</span></span> <span data-ttu-id="28376-115">您还可以使用 PowerShell 配置缓解。</span><span class="sxs-lookup"><span data-stu-id="28376-115">You can also configure the mitigations with PowerShell.</span></span>

<span data-ttu-id="28376-116">本文列出了 Exploit Protection 中可用的每个缓解。</span><span class="sxs-lookup"><span data-stu-id="28376-116">This article lists each of the mitigations available in exploit protection.</span></span> <span data-ttu-id="28376-117">它指示是否可以将缓解应用于系统范围或个别应用，并简要说明缓解的工作原理。</span><span class="sxs-lookup"><span data-stu-id="28376-117">It indicates whether the mitigation can be applied system-wide or to individual apps, and provides a brief description of how the mitigation works.</span></span>

<span data-ttu-id="28376-118">它还介绍了如何使用 Windows 安全、PowerShell 和移动设备管理 (MDM) 配置服务提供程序 (或配置) 。</span><span class="sxs-lookup"><span data-stu-id="28376-118">It also describes how to enable or configure the mitigations using Windows Security, PowerShell, and mobile device management (MDM) configuration service providers (CSPs).</span></span> <span data-ttu-id="28376-119">这是创建可跨网络部署的配置的第一步。</span><span class="sxs-lookup"><span data-stu-id="28376-119">This is the first step in creating a configuration that you can deploy across your network.</span></span> <span data-ttu-id="28376-120">下一步涉及 [生成、导出、导入配置以及将配置部署到多台设备](import-export-exploit-protection-emet-xml.md)。</span><span class="sxs-lookup"><span data-stu-id="28376-120">The next step involves [generating, exporting, importing, and deploying the configuration to multiple devices](import-export-exploit-protection-emet-xml.md).</span></span>

> [!WARNING]
> <span data-ttu-id="28376-121">某些安全缓解技术在某些应用程序中可能有兼容性问题。</span><span class="sxs-lookup"><span data-stu-id="28376-121">Some security mitigation technologies may have compatibility issues with some applications.</span></span> <span data-ttu-id="28376-122">在生产环境或网络的其余部分部署配置之前，你应该使用审核模式[](evaluate-exploit-protection.md)在所有目标使用方案中测试 Exploit Protection。</span><span class="sxs-lookup"><span data-stu-id="28376-122">You should test exploit protection in all target use scenarios by using [audit mode](evaluate-exploit-protection.md) before deploying the configuration across a production environment or the rest of your network.</span></span>

## <a name="exploit-protection-mitigations"></a><span data-ttu-id="28376-123">Exploit Protection 缓解</span><span class="sxs-lookup"><span data-stu-id="28376-123">Exploit protection mitigations</span></span>

<span data-ttu-id="28376-124">可以针对单个应用配置所有缓解。</span><span class="sxs-lookup"><span data-stu-id="28376-124">All mitigations can be configured for individual apps.</span></span> <span data-ttu-id="28376-125">某些缓解还可以在操作系统级别应用。</span><span class="sxs-lookup"><span data-stu-id="28376-125">Some mitigations can also be applied at the operating system level.</span></span>

<span data-ttu-id="28376-126">你可以将每个缓解设置为打开、关闭或设置为其默认值。</span><span class="sxs-lookup"><span data-stu-id="28376-126">You can set each of the mitigations on, off, or to their default value.</span></span> <span data-ttu-id="28376-127">某些缓解具有表的说明中指示的其他选项。</span><span class="sxs-lookup"><span data-stu-id="28376-127">Some mitigations have additional options that are indicated in the description in the table.</span></span>

<span data-ttu-id="28376-128">默认值始终在"使用每个缓解的默认选项" **的** 括号中指定。</span><span class="sxs-lookup"><span data-stu-id="28376-128">Default values are always specified in brackets at the **Use default** option for each mitigation.</span></span> <span data-ttu-id="28376-129">在下面的示例中，数据执行保护的默认值为"On"。</span><span class="sxs-lookup"><span data-stu-id="28376-129">In the following example, the default for Data Execution Prevention is "On".</span></span>

<span data-ttu-id="28376-130">" **使用** 每个缓解设置的默认配置"指示我们针对家庭用户日常使用的基本保护级别的建议。</span><span class="sxs-lookup"><span data-stu-id="28376-130">The **Use default** configuration for each of the mitigation settings indicates our recommendation for a base level of protection for everyday usage for home users.</span></span> <span data-ttu-id="28376-131">企业部署应考虑其个人需求所需的保护，并且可能需要修改默认值的配置。</span><span class="sxs-lookup"><span data-stu-id="28376-131">Enterprise deployments should consider the protection required for their individual needs and may need to modify configuration away from the defaults.</span></span>

<span data-ttu-id="28376-132">有关每个缓解的关联 PowerShell cmdlet，请参阅本文底部的 [PowerShell](#cmdlets-table) 参考表。</span><span class="sxs-lookup"><span data-stu-id="28376-132">For the associated PowerShell cmdlets for each mitigation, see the [PowerShell reference table](#cmdlets-table) at the bottom of this article.</span></span>

| <span data-ttu-id="28376-133">缓解措施</span><span class="sxs-lookup"><span data-stu-id="28376-133">Mitigation</span></span> | <span data-ttu-id="28376-134">说明</span><span class="sxs-lookup"><span data-stu-id="28376-134">Description</span></span> | <span data-ttu-id="28376-135">可应用于</span><span class="sxs-lookup"><span data-stu-id="28376-135">Can be applied to</span></span> | <span data-ttu-id="28376-136">审核模式可用</span><span class="sxs-lookup"><span data-stu-id="28376-136">Audit mode available</span></span> |
| ---------- | ----------- | ----------------- | -------------------- |
| <span data-ttu-id="28376-137">控制流保护 (CFG) </span><span class="sxs-lookup"><span data-stu-id="28376-137">Control flow guard (CFG)</span></span> | <span data-ttu-id="28376-138">确保间接调用的控制流完整性。</span><span class="sxs-lookup"><span data-stu-id="28376-138">Ensures control flow integrity for indirect calls.</span></span> <span data-ttu-id="28376-139">可以选择禁止导出并使用严格的 CFG。</span><span class="sxs-lookup"><span data-stu-id="28376-139">Can optionally suppress exports and use strict CFG.</span></span> | <span data-ttu-id="28376-140">系统和应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-140">System and app-level</span></span> | ![选中标记否](/security/defender-endpoint/images/svg/check-no) |
| <span data-ttu-id="28376-142">数据执行保护 (DEP) </span><span class="sxs-lookup"><span data-stu-id="28376-142">Data Execution Prevention (DEP)</span></span> | <span data-ttu-id="28376-143">防止从仅数据内存页（如堆和堆栈）运行代码。</span><span class="sxs-lookup"><span data-stu-id="28376-143">Prevents code from being run from data-only memory pages such as the heap and stacks.</span></span> <span data-ttu-id="28376-144">仅可针对 32 位 (x86) 应用进行配置，并针对所有其他体系结构永久启用。</span><span class="sxs-lookup"><span data-stu-id="28376-144">Only configurable for 32-bit (x86) apps, permanently enabled for all other architectures.</span></span> <span data-ttu-id="28376-145">可以选择启用 ATL thunk 模拟。</span><span class="sxs-lookup"><span data-stu-id="28376-145">Can optionally enable ATL thunk emulation.</span></span> | <span data-ttu-id="28376-146">系统和应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-146">System and app-level</span></span>  | ![选中标记否](/security/defender-endpoint/images/svg/check-no) |
| <span data-ttu-id="28376-148">强制图像随机化 (强制 ASLR) </span><span class="sxs-lookup"><span data-stu-id="28376-148">Force randomization for images (Mandatory ASLR)</span></span> | <span data-ttu-id="28376-149">强制重定位未使用 /DYNAMICBASE 编译的图像。</span><span class="sxs-lookup"><span data-stu-id="28376-149">Forcibly relocates images not compiled with /DYNAMICBASE.</span></span> <span data-ttu-id="28376-150">（可选）无法加载没有重定位信息的图像。</span><span class="sxs-lookup"><span data-stu-id="28376-150">Can optionally fail loading images that don't have relocation information.</span></span> | <span data-ttu-id="28376-151">系统和应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-151">System and app-level</span></span>  | ![选中标记否](/security/defender-endpoint/images/svg/check-no) |
| <span data-ttu-id="28376-153">从下向上 ASLR (随机分配) </span><span class="sxs-lookup"><span data-stu-id="28376-153">Randomize memory allocations (Bottom-Up ASLR)</span></span> | <span data-ttu-id="28376-154">随机化虚拟内存分配的位置。</span><span class="sxs-lookup"><span data-stu-id="28376-154">Randomizes locations for virtual memory allocations.</span></span> <span data-ttu-id="28376-155">它包括系统结构堆、堆栈、TEB 和 PEB。</span><span class="sxs-lookup"><span data-stu-id="28376-155">It includes system structure heaps, stacks, TEBs, and PEBs.</span></span> <span data-ttu-id="28376-156">可以选择对 64 位进程使用更大的随机化差异。</span><span class="sxs-lookup"><span data-stu-id="28376-156">Can optionally use a wider randomization variance for 64-bit processes.</span></span> | <span data-ttu-id="28376-157">系统和应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-157">System and app-level</span></span> | ![选中标记否](/security/defender-endpoint/images/svg/check-no) |
| <span data-ttu-id="28376-159">验证 SEHOP (异常) </span><span class="sxs-lookup"><span data-stu-id="28376-159">Validate exception chains (SEHOP)</span></span> | <span data-ttu-id="28376-160">确保异常调度期间异常链的完整性。</span><span class="sxs-lookup"><span data-stu-id="28376-160">Ensures the integrity of an exception chain during exception dispatch.</span></span> <span data-ttu-id="28376-161">仅可配置 32 位 (x86) 应用程序。</span><span class="sxs-lookup"><span data-stu-id="28376-161">Only configurable for 32-bit (x86) applications.</span></span> | <span data-ttu-id="28376-162">系统和应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-162">System and app-level</span></span>  | ![选中标记否](/security/defender-endpoint/images/svg/check-no) |
| <span data-ttu-id="28376-164">验证堆完整性</span><span class="sxs-lookup"><span data-stu-id="28376-164">Validate heap integrity</span></span> | <span data-ttu-id="28376-165">在检测到堆损坏时终止进程。</span><span class="sxs-lookup"><span data-stu-id="28376-165">Terminates a process when heap corruption is detected.</span></span> | <span data-ttu-id="28376-166">系统和应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-166">System and app-level</span></span>  | ![选中标记否](/security/defender-endpoint/images/svg/check-no) |
| <span data-ttu-id="28376-168">ACG (任意代码) </span><span class="sxs-lookup"><span data-stu-id="28376-168">Arbitrary code guard (ACG)</span></span> | <span data-ttu-id="28376-169">阻止引入非图像支持的可执行代码，并阻止修改代码页。</span><span class="sxs-lookup"><span data-stu-id="28376-169">Prevents the introduction of non-image-backed executable code and prevents code pages from being modified.</span></span> <span data-ttu-id="28376-170">可以选择允许线程退出并允许远程降级 (PowerShell) 。</span><span class="sxs-lookup"><span data-stu-id="28376-170">Can optionally allow thread opt-out and allow remote downgrade (configurable only with PowerShell).</span></span> | <span data-ttu-id="28376-171">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-171">App-level only</span></span> | ![选中标记是](/security/defender-endpoint/images/svg/check-yes) |
| <span data-ttu-id="28376-173">阻止低完整性图像</span><span class="sxs-lookup"><span data-stu-id="28376-173">Block low integrity images</span></span> | <span data-ttu-id="28376-174">阻止加载标记为低完整性的图像。</span><span class="sxs-lookup"><span data-stu-id="28376-174">Prevents the loading of images marked with Low Integrity.</span></span> | <span data-ttu-id="28376-175">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-175">App-level only</span></span> | ![选中标记是](/security/defender-endpoint/images/svg/check-yes)|
| <span data-ttu-id="28376-177">阻止远程图像</span><span class="sxs-lookup"><span data-stu-id="28376-177">Block remote images</span></span> | <span data-ttu-id="28376-178">阻止从远程设备加载图像。</span><span class="sxs-lookup"><span data-stu-id="28376-178">Prevents loading of images from remote devices.</span></span> | <span data-ttu-id="28376-179">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-179">App-level only</span></span> | <span data-ttu-id="28376-180">![Check mark no] (/security/defender-endpoint/images/svg/check-no</span><span class="sxs-lookup"><span data-stu-id="28376-180">![Check mark no](/security/defender-endpoint/images/svg/check-no</span></span> |
| <span data-ttu-id="28376-181">阻止不受信任的字体</span><span class="sxs-lookup"><span data-stu-id="28376-181">Block untrusted fonts</span></span> | <span data-ttu-id="28376-182">阻止加载系统字体目录中未安装的任何基于 GDI 的字体，尤其是来自 Web 的字体。</span><span class="sxs-lookup"><span data-stu-id="28376-182">Prevents loading any GDI-based fonts not installed in the system fonts directory, notably fonts from the web.</span></span> | <span data-ttu-id="28376-183">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-183">App-level only</span></span> | <span data-ttu-id="28376-184">！include[Check mark yes](/security/defender-endpoint/images/svg/check-yes)</span><span class="sxs-lookup"><span data-stu-id="28376-184">!include[Check mark yes](/security/defender-endpoint/images/svg/check-yes)</span></span> |
| <span data-ttu-id="28376-185">代码完整性防护</span><span class="sxs-lookup"><span data-stu-id="28376-185">Code integrity guard</span></span> | <span data-ttu-id="28376-186">限制加载由 Microsoft、WHQL 或更高版本签名的图像。</span><span class="sxs-lookup"><span data-stu-id="28376-186">Restricts loading of images signed by Microsoft, WHQL, or higher.</span></span> <span data-ttu-id="28376-187">可以选择允许 Microsoft Store 签名的图像。</span><span class="sxs-lookup"><span data-stu-id="28376-187">Can optionally allow Microsoft Store signed images.</span></span> | <span data-ttu-id="28376-188">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-188">App-level only</span></span> | ![选中标记是](/security/defender-endpoint/images/svg/check-yes) |
| <span data-ttu-id="28376-190">禁用扩展点</span><span class="sxs-lookup"><span data-stu-id="28376-190">Disable extension points</span></span> | <span data-ttu-id="28376-191">禁用允许 DLL 注入到所有进程（如 AppInit DLL、窗口挂钩和 Winsock 服务提供商）的各种扩展性机制。</span><span class="sxs-lookup"><span data-stu-id="28376-191">Disables various extensibility mechanisms that allow DLL injection into all processes, such as AppInit DLLs, window hooks, and Winsock service providers.</span></span> | <span data-ttu-id="28376-192">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-192">App-level only</span></span> | ![选中标记否](/security/defender-endpoint/images/svg/check-no) |
| <span data-ttu-id="28376-194">禁用 Win32k 系统调用</span><span class="sxs-lookup"><span data-stu-id="28376-194">Disable Win32k system calls</span></span> | <span data-ttu-id="28376-195">阻止应用使用 Win32k 系统调用表。</span><span class="sxs-lookup"><span data-stu-id="28376-195">Prevents an app from using the Win32k system call table.</span></span> | <span data-ttu-id="28376-196">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-196">App-level only</span></span> | ![选中标记是](/security/defender-endpoint/images/svg/check-yes) |
| <span data-ttu-id="28376-198">不允许子进程</span><span class="sxs-lookup"><span data-stu-id="28376-198">Don't allow child processes</span></span> | <span data-ttu-id="28376-199">阻止应用创建子进程。</span><span class="sxs-lookup"><span data-stu-id="28376-199">Prevents an app from creating child processes.</span></span> | <span data-ttu-id="28376-200">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-200">App-level only</span></span> | ![选中标记是](/security/defender-endpoint/images/svg/check-yes) |
| <span data-ttu-id="28376-202">导出 EAF (地址) </span><span class="sxs-lookup"><span data-stu-id="28376-202">Export address filtering (EAF)</span></span> | <span data-ttu-id="28376-203">检测恶意代码正在解决危险操作。</span><span class="sxs-lookup"><span data-stu-id="28376-203">Detects dangerous operations being resolved by malicious code.</span></span> <span data-ttu-id="28376-204">可以选择验证攻击常用的模块的访问。</span><span class="sxs-lookup"><span data-stu-id="28376-204">Can optionally validate access by modules commonly used by exploits.</span></span> | <span data-ttu-id="28376-205">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-205">App-level only</span></span> | ![选中标记是](/security/defender-endpoint/images/svg/check-yes) |
| <span data-ttu-id="28376-207">在 IAF (导入) </span><span class="sxs-lookup"><span data-stu-id="28376-207">Import address filtering (IAF)</span></span> | <span data-ttu-id="28376-208">检测恶意代码正在解决危险操作。</span><span class="sxs-lookup"><span data-stu-id="28376-208">Detects dangerous operations being resolved by malicious code.</span></span> | <span data-ttu-id="28376-209">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-209">App-level only</span></span> | ![选中标记是](/security/defender-endpoint/images/svg/check-yes) |
| <span data-ttu-id="28376-211">模拟 SimExec (执行) </span><span class="sxs-lookup"><span data-stu-id="28376-211">Simulate execution (SimExec)</span></span> | <span data-ttu-id="28376-212">确保对敏感 API 的调用返回到合法的调用方。</span><span class="sxs-lookup"><span data-stu-id="28376-212">Ensures that calls to sensitive APIs return to legitimate callers.</span></span> <span data-ttu-id="28376-213">仅可配置 32 位 (x86) 应用程序。</span><span class="sxs-lookup"><span data-stu-id="28376-213">Only configurable for 32-bit (x86) applications.</span></span> <span data-ttu-id="28376-214">与 ACG 不兼容</span><span class="sxs-lookup"><span data-stu-id="28376-214">Not compatible with ACG</span></span> | <span data-ttu-id="28376-215">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-215">App-level only</span></span> | ![选中标记是](/security/defender-endpoint/images/svg/check-yes) |
| <span data-ttu-id="28376-217">验证 CallerCheck (API) </span><span class="sxs-lookup"><span data-stu-id="28376-217">Validate API invocation (CallerCheck)</span></span> | <span data-ttu-id="28376-218">确保合法调用方调用敏感 API。</span><span class="sxs-lookup"><span data-stu-id="28376-218">Ensures that sensitive APIs are invoked by legitimate callers.</span></span> <span data-ttu-id="28376-219">仅可配置 32 位 (x86) 应用程序。</span><span class="sxs-lookup"><span data-stu-id="28376-219">Only configurable for 32-bit (x86) applications.</span></span> <span data-ttu-id="28376-220">与 ACG 不兼容</span><span class="sxs-lookup"><span data-stu-id="28376-220">Not compatible with ACG</span></span> | <span data-ttu-id="28376-221">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-221">App-level only</span></span> | ![选中标记是](/security/defender-endpoint/images/svg/check-yes) |
| <span data-ttu-id="28376-223">验证句柄使用情况</span><span class="sxs-lookup"><span data-stu-id="28376-223">Validate handle usage</span></span> | <span data-ttu-id="28376-224">导致在任何无效句柄引用上引发异常。</span><span class="sxs-lookup"><span data-stu-id="28376-224">Causes an exception to be raised on any invalid handle references.</span></span> | <span data-ttu-id="28376-225">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-225">App-level only</span></span> | ![选中标记否](/security/defender-endpoint/images/svg/check-no) |
| <span data-ttu-id="28376-227">验证图像依赖关系完整性</span><span class="sxs-lookup"><span data-stu-id="28376-227">Validate image dependency integrity</span></span> | <span data-ttu-id="28376-228">强制对 Windows 映像依赖关系加载进行代码签名。</span><span class="sxs-lookup"><span data-stu-id="28376-228">Enforces code signing for Windows image dependency loading.</span></span> | <span data-ttu-id="28376-229">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-229">App-level only</span></span> | ![选中标记否](/security/defender-endpoint/images/svg/check-no) |
| <span data-ttu-id="28376-231">验证 StackPivot (堆栈) </span><span class="sxs-lookup"><span data-stu-id="28376-231">Validate stack integrity (StackPivot)</span></span> | <span data-ttu-id="28376-232">确保堆栈尚未针对敏感 API 进行重定向。</span><span class="sxs-lookup"><span data-stu-id="28376-232">Ensures that the stack hasn't been redirected for sensitive APIs.</span></span> <span data-ttu-id="28376-233">与 ACG 不兼容</span><span class="sxs-lookup"><span data-stu-id="28376-233">Not compatible with ACG</span></span> | <span data-ttu-id="28376-234">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-234">App-level only</span></span> | ![选中标记是](/security/defender-endpoint/images/svg/check-yes) |


> [!IMPORTANT]
> <span data-ttu-id="28376-236">如果你将应用添加到计划 **设置部分，** 并在那里配置个别缓解设置，则它们在"系统设置"部分中指定的相同缓解 **的配置上方会获得** 支持。</span><span class="sxs-lookup"><span data-stu-id="28376-236">If you add an app to the **Program settings** section and configure individual mitigation settings there, they will be honored above the configuration for the same mitigations specified in the **System settings** section.</span></span> <span data-ttu-id="28376-237">以下矩阵和示例可帮助说明默认设置如何工作：</span><span class="sxs-lookup"><span data-stu-id="28376-237">The following matrix and examples help to illustrate how defaults work:</span></span>
>
>
> | <span data-ttu-id="28376-238">在程序 **设置中启用**</span><span class="sxs-lookup"><span data-stu-id="28376-238">Enabled in **Program settings**</span></span> | <span data-ttu-id="28376-239">在系统 **设置中启用**</span><span class="sxs-lookup"><span data-stu-id="28376-239">Enabled in **System settings**</span></span> | <span data-ttu-id="28376-240">行为</span><span class="sxs-lookup"><span data-stu-id="28376-240">Behavior</span></span> |
> | ------------------------------- | ------------------------------ | -------- |
> | ![选中标记是](/security/defender-endpoint/images/svg/check-yes) | ![选中标记否](/security/defender-endpoint/images/svg/check-no) | <span data-ttu-id="28376-243">如程序 **设置中的定义**</span><span class="sxs-lookup"><span data-stu-id="28376-243">As defined in **Program settings**</span></span> |
> | ![选中标记是](/security/defender-endpoint/images/svg/check-yes) | ![选中标记是](/security/defender-endpoint/images/svg/check-yes) | <span data-ttu-id="28376-246">如程序 **设置中的定义**</span><span class="sxs-lookup"><span data-stu-id="28376-246">As defined in **Program settings**</span></span> |
> | ![选中标记否](/security/defender-endpoint/images/svg/check-no) | ![选中标记是](/security/defender-endpoint/images/svg/check-yes) | <span data-ttu-id="28376-249">如系统 **设置中的定义**</span><span class="sxs-lookup"><span data-stu-id="28376-249">As defined in **System settings**</span></span> |
> | ![选中标记否](/security/defender-endpoint/images/svg/check-no) | ![选中标记是](/security/defender-endpoint/images/svg/check-yes) | <span data-ttu-id="28376-252">默认，如 **使用默认选项** 中定义</span><span class="sxs-lookup"><span data-stu-id="28376-252">Default as defined in **Use default** option</span></span> |
>
>
>
> * <span data-ttu-id="28376-253">**示例 1**</span><span class="sxs-lookup"><span data-stu-id="28376-253">**Example 1**</span></span>
>
>    <span data-ttu-id="28376-254">M一el 将"系统 (中的 **DEP** **) 数据执行** 保护配置为默认 **为"关闭"。**</span><span class="sxs-lookup"><span data-stu-id="28376-254">Mikael configures **Data Execution Prevention (DEP)** in the **System settings** section to be **Off by default**.</span></span>
>
>    <span data-ttu-id="28376-255">然后，M一el 将应用 *test.exe* 程序 **设置"** 部分。</span><span class="sxs-lookup"><span data-stu-id="28376-255">Mikael then adds the app *test.exe* to the **Program settings** section.</span></span> <span data-ttu-id="28376-256">在该应用的选项中，在"数据执行保护 (**DEP**) "下，他启用"覆盖系统设置"选项，将开关设置为 **"开"。**</span><span class="sxs-lookup"><span data-stu-id="28376-256">In the options for that app, under **Data Execution Prevention (DEP)**, he enables the **Override system settings** option and sets the switch to **On**.</span></span> <span data-ttu-id="28376-257">"程序设置"部分未列出 **任何其他** 应用。</span><span class="sxs-lookup"><span data-stu-id="28376-257">There are no other apps listed in the **Program settings** section.</span></span>
>
>    <span data-ttu-id="28376-258">结果是仅对启用 DEP 的 *test.exe。*</span><span class="sxs-lookup"><span data-stu-id="28376-258">The result will be that DEP only will be enabled for *test.exe*.</span></span> <span data-ttu-id="28376-259">所有其他应用将不会应用 DEP。</span><span class="sxs-lookup"><span data-stu-id="28376-259">All other apps will not have DEP applied.</span></span>
>
>
> * <span data-ttu-id="28376-260">**示例 2**</span><span class="sxs-lookup"><span data-stu-id="28376-260">**Example 2**</span></span>
>
>    <span data-ttu-id="28376-261">Josie 在"系统 **(")\*\*\*\*中** 将"数据执行保护"配置为"默认 **关闭"。**</span><span class="sxs-lookup"><span data-stu-id="28376-261">Josie configures **Data Execution Prevention (DEP)** in the **System settings** section to be **Off by default**.</span></span>
>
>    <span data-ttu-id="28376-262">然后，Josie 将应用 *test.exe* 程序 **设置部分** 。</span><span class="sxs-lookup"><span data-stu-id="28376-262">Josie then adds the app *test.exe* to the **Program settings** section.</span></span> <span data-ttu-id="28376-263">在该应用的选项中，在"数据执行保护 (**DEP**) "下，她启用"覆盖系统设置"选项，将开关设置为 **"开"。**</span><span class="sxs-lookup"><span data-stu-id="28376-263">In the options for that app, under **Data Execution Prevention (DEP)**, she enables the **Override system settings** option and sets the switch to **On**.</span></span>
>
>    <span data-ttu-id="28376-264">Josie 还将应用miles.exe添加到程序设置部分，并将控制流保护 (**CFG**) **设置为开**。</span><span class="sxs-lookup"><span data-stu-id="28376-264">Josie also adds the app *miles.exe* to the **Program settings** section and configures **Control flow guard (CFG)** to **On**.</span></span> <span data-ttu-id="28376-265">她未为 DEP或该应用的其他任何缓解启用替代系统设置选项。</span><span class="sxs-lookup"><span data-stu-id="28376-265">She doesn't enable the **Override system settings** option for DEP or any other mitigations for that app.</span></span>
>
>    <span data-ttu-id="28376-266">结果是将启用 DEP *以启用* test.exe。</span><span class="sxs-lookup"><span data-stu-id="28376-266">The result will be that DEP will be enabled for *test.exe*.</span></span> <span data-ttu-id="28376-267">不会为任何其他应用启用 DEP，包括miles.exe。 \*\*</span><span class="sxs-lookup"><span data-stu-id="28376-267">DEP will not be enabled for any other app, including *miles.exe*.</span></span> <span data-ttu-id="28376-268">CFG *将启用* miles.exe。</span><span class="sxs-lookup"><span data-stu-id="28376-268">CFG will be enabled for *miles.exe*.</span></span>

> [!NOTE]
> <span data-ttu-id="28376-269">如果发现本文中的问题，可以直接向 Windows Server/Windows 客户端合作伙伴报告，或使用你国家/地区 Microsoft 技术支持号码。</span><span class="sxs-lookup"><span data-stu-id="28376-269">If you have found any issues in this article, you can report it directly to a Windows Server/Windows Client partner or use the Microsoft technical support numbers for your country.</span></span>

### <a name="configure-system-level-mitigations-with-the-windows-security-app"></a><span data-ttu-id="28376-270">使用 Windows 安全应用配置系统级缓解</span><span class="sxs-lookup"><span data-stu-id="28376-270">Configure system-level mitigations with the Windows Security app</span></span>

1. <span data-ttu-id="28376-271">通过选择任务栏中的防护图标或搜索 Defender 的"开始"菜单打开 Windows 安全 **应用**。</span><span class="sxs-lookup"><span data-stu-id="28376-271">Open the Windows Security app by selecting the shield icon in the task bar or searching the start menu for **Defender**.</span></span>

2. <span data-ttu-id="28376-272">选择应用 **&浏览器控制** 磁贴 (或左侧菜单栏上的应用图标) 选择 Exploit **Protection**。</span><span class="sxs-lookup"><span data-stu-id="28376-272">Select the **App & browser control** tile (or the app icon on the left menu bar) and then select **Exploit protection**.</span></span>

3. <span data-ttu-id="28376-273">在 **"系统设置** "部分下，找到你要配置的缓解并选择以下选项之一。</span><span class="sxs-lookup"><span data-stu-id="28376-273">Under the **System settings** section, find the mitigation you want to configure and select one of the following.</span></span> <span data-ttu-id="28376-274">未在"程序设置"部分单独 **配置的应用将使用** 此处配置的设置：</span><span class="sxs-lookup"><span data-stu-id="28376-274">Apps that aren't configured individually in the **Program settings** section will use the settings configured here:</span></span>
   * <span data-ttu-id="28376-275">**默认启用**- 为在特定于应用的程序设置部分中未设置此缓解的应用 **启用缓解**</span><span class="sxs-lookup"><span data-stu-id="28376-275">**On by default** - The mitigation is *enabled* for apps that don't have this mitigation set in the app-specific **Program settings** section</span></span>
   * <span data-ttu-id="28376-276">**默认情况下关闭**- 对在特定于应用的程序设置部分中没有设置此缓解的应用 **禁用缓解**</span><span class="sxs-lookup"><span data-stu-id="28376-276">**Off by default** - The mitigation is *disabled* for apps that don't have this mitigation set in the app-specific **Program settings** section</span></span>
   * <span data-ttu-id="28376-277">**使用默认值**- 根据 Windows 10 安装设置的默认配置，启用或禁用缓解;默认值为 **" ("** 或"关闭") 始终在每个缓解 **的"使用** 默认标签"旁边指定</span><span class="sxs-lookup"><span data-stu-id="28376-277">**Use default** - The mitigation is either enabled or disabled, depending on the default configuration that is set up by Windows 10 installation; the default value (**On** or **Off**) is always specified next to the **Use default** label for each mitigation</span></span>

   > [!NOTE]
   > <span data-ttu-id="28376-278">更改某些设置时，可能会看到"用户帐户控制"窗口。</span><span class="sxs-lookup"><span data-stu-id="28376-278">You may see a User Account Control window when changing some settings.</span></span> <span data-ttu-id="28376-279">输入管理员凭据以应用该设置。</span><span class="sxs-lookup"><span data-stu-id="28376-279">Enter administrator credentials to apply the setting.</span></span>

   <span data-ttu-id="28376-280">更改某些设置可能需要重新启动。</span><span class="sxs-lookup"><span data-stu-id="28376-280">Changing some settings may require a restart.</span></span>

4. <span data-ttu-id="28376-281">对要配置的所有系统级缓解重复此操作。</span><span class="sxs-lookup"><span data-stu-id="28376-281">Repeat this for all the system-level mitigations you want to configure.</span></span>

5. <span data-ttu-id="28376-282">转到计划 **设置** 部分，然后选择你要应用缓解的应用：</span><span class="sxs-lookup"><span data-stu-id="28376-282">Go to the **Program settings** section and choose the app you want to apply mitigations to:</span></span>

   1. <span data-ttu-id="28376-283">如果已列出要配置的应用，请选择它，然后选择"编辑 **"**</span><span class="sxs-lookup"><span data-stu-id="28376-283">If the app you want to configure is already listed, select it and then select **Edit**</span></span>
   2. <span data-ttu-id="28376-284">如果未列出应用，请在列表顶部选择"添加程序以自定义"，然后选择想要添加应用：</span><span class="sxs-lookup"><span data-stu-id="28376-284">If the app isn't listed, at the top of the list select **Add program to customize** and then choose how you want to add the app:</span></span>
      * <span data-ttu-id="28376-285">使用 **"按程序名称** 添加"将缓解应用于具有该名称的任何正在运行的进程。</span><span class="sxs-lookup"><span data-stu-id="28376-285">Use **Add by program name** to have the mitigation applied to any running process with that name.</span></span> <span data-ttu-id="28376-286">必须指定具有扩展名的文件。</span><span class="sxs-lookup"><span data-stu-id="28376-286">You must specify a file with an extension.</span></span> <span data-ttu-id="28376-287">你可以输入完整路径，将缓解限制为仅该位置中具有该名称的应用。</span><span class="sxs-lookup"><span data-stu-id="28376-287">You can enter a full path to limit the mitigation to only the app with that name in that location.</span></span>
      * <span data-ttu-id="28376-288">Use **Choose exact file path** to use a standard Windows Explorer file picker window to find and select the file you want.</span><span class="sxs-lookup"><span data-stu-id="28376-288">Use **Choose exact file path** to use a standard Windows Explorer file picker window to find and select the file you want.</span></span>

6. <span data-ttu-id="28376-289">选择应用后，你将看到可应用的所有缓解的列表。</span><span class="sxs-lookup"><span data-stu-id="28376-289">After selecting the app, you'll see a list of all the mitigations that can be applied.</span></span> <span data-ttu-id="28376-290">若要启用缓解，请选中复选框，然后将滑块更改为 **"打开"。**</span><span class="sxs-lookup"><span data-stu-id="28376-290">To enable the mitigation, select the check box and then change the slider to **On**.</span></span> <span data-ttu-id="28376-291">选择任何其他选项。</span><span class="sxs-lookup"><span data-stu-id="28376-291">Select any additional options.</span></span> <span data-ttu-id="28376-292">选择 **审核** 将仅在审核模式下应用缓解。</span><span class="sxs-lookup"><span data-stu-id="28376-292">Choosing **Audit** will apply the mitigation in audit mode only.</span></span> <span data-ttu-id="28376-293">如果需要重新启动进程或应用，或者需要重新启动 Windows，将通知你。</span><span class="sxs-lookup"><span data-stu-id="28376-293">You will be notified if you need to restart the process or app, or if you need to restart Windows.</span></span>

7. <span data-ttu-id="28376-294">对要配置的所有应用和缓解重复这些步骤。</span><span class="sxs-lookup"><span data-stu-id="28376-294">Repeat these steps for all the apps and mitigations you want to configure.</span></span> <span data-ttu-id="28376-295">完成 **配置** 设置后，选择"应用"。</span><span class="sxs-lookup"><span data-stu-id="28376-295">Select **Apply** when you're done setting up your configuration.</span></span>

<span data-ttu-id="28376-296">你现在可以将 [这些设置导出为 XML 文件，](import-export-exploit-protection-emet-xml.md) 也可以继续配置特定于应用的缓解。</span><span class="sxs-lookup"><span data-stu-id="28376-296">You can now [export these settings as an XML file](import-export-exploit-protection-emet-xml.md) or continue on to configure app-specific mitigations.</span></span>

<span data-ttu-id="28376-297">将配置导出为 XML 文件后，你可以将配置从一台设备复制到其他设备。</span><span class="sxs-lookup"><span data-stu-id="28376-297">Exporting the configuration as an XML file allows you to copy the configuration from one device onto other devices.</span></span>

## <a name="powershell-reference"></a><span data-ttu-id="28376-298">PowerShell 参考</span><span class="sxs-lookup"><span data-stu-id="28376-298">PowerShell reference</span></span>

<span data-ttu-id="28376-299">可以使用 Windows 安全应用配置 Exploit Protection，或者使用 PowerShell cmdlet。</span><span class="sxs-lookup"><span data-stu-id="28376-299">You can use the Windows Security app to configure Exploit protection, or you can use PowerShell cmdlets.</span></span>

<span data-ttu-id="28376-300">将始终应用最近修改的配置设置 -无论你是使用 PowerShell 还是 Windows 安全。</span><span class="sxs-lookup"><span data-stu-id="28376-300">The configuration settings that were most recently modified will always be applied - regardless of whether you use PowerShell or Windows Security.</span></span> <span data-ttu-id="28376-301">这意味着，如果你使用该应用配置缓解，然后使用 PowerShell 配置相同的缓解，应用将更新以显示你使用 PowerShell 所做的更改。</span><span class="sxs-lookup"><span data-stu-id="28376-301">This means that if you use the app to configure a mitigation, then use PowerShell to configure the same mitigation, the app will update to show the changes you made with PowerShell.</span></span> <span data-ttu-id="28376-302">如果你随后使用该应用再次更改缓解，该更改将适用。</span><span class="sxs-lookup"><span data-stu-id="28376-302">If you were to then use the app to change the mitigation again, that change would apply.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="28376-303">通过组策略部署到设备的任何更改都将覆盖本地配置。</span><span class="sxs-lookup"><span data-stu-id="28376-303">Any changes that are deployed to a device through Group Policy will override the local configuration.</span></span> <span data-ttu-id="28376-304">设置初始配置时，请使用不会应用组策略配置的设备，以确保你的更改不会覆盖。</span><span class="sxs-lookup"><span data-stu-id="28376-304">When setting up an initial configuration, use a device that will not have a Group Policy configuration applied to ensure your changes aren't overridden.</span></span>

<span data-ttu-id="28376-305">可以使用 PowerShell 动词或 `Get` `Set` cmdlet `ProcessMitigation` 。</span><span class="sxs-lookup"><span data-stu-id="28376-305">You can use the PowerShell verb `Get` or `Set` with the cmdlet `ProcessMitigation`.</span></span> <span data-ttu-id="28376-306">使用 将列出设备上已启用的任何缓解的当前配置状态 - 添加 cmdlet 和 app exe 以查看仅 `Get` `-Name` 该应用的缓解：</span><span class="sxs-lookup"><span data-stu-id="28376-306">Using `Get` will list the current configuration status of any mitigations that have been enabled on the device - add the `-Name` cmdlet and app exe to see mitigations for just that app:</span></span>

```PowerShell
Get-ProcessMitigation -Name processName.exe
```

> [!IMPORTANT]
> <span data-ttu-id="28376-307">尚未配置的系统级别缓解将显示 状态 `NOTSET` 。</span><span class="sxs-lookup"><span data-stu-id="28376-307">System-level mitigations that have not been configured will show a status of `NOTSET`.</span></span>
>
> <span data-ttu-id="28376-308">对于系统级别的设置 `NOTSET` ，指示已应用该缓解的默认设置。</span><span class="sxs-lookup"><span data-stu-id="28376-308">For system-level settings, `NOTSET` indicates the default setting for that mitigation has been applied.</span></span>
>
> <span data-ttu-id="28376-309">对于应用级别的设置，指示将应用缓解 `NOTSET` 的系统级别设置。</span><span class="sxs-lookup"><span data-stu-id="28376-309">For app-level settings, `NOTSET` indicates the system-level setting for the mitigation will be applied.</span></span>
>
> <span data-ttu-id="28376-310">每个系统级别缓解的默认设置都可以在 Windows 安全机制中看到。</span><span class="sxs-lookup"><span data-stu-id="28376-310">The default setting for each system-level mitigation can be seen in the Windows Security.</span></span>

<span data-ttu-id="28376-311">使用以下 `Set` 格式配置每个缓解：</span><span class="sxs-lookup"><span data-stu-id="28376-311">Use `Set` to configure each mitigation in the following format:</span></span>

```PowerShell
Set-ProcessMitigation -<scope> <app executable> -<action> <mitigation or options>,<mitigation or options>,<mitigation or options>
```

<span data-ttu-id="28376-312">其中：</span><span class="sxs-lookup"><span data-stu-id="28376-312">Where:</span></span>

* <span data-ttu-id="28376-313">\<Scope>:</span><span class="sxs-lookup"><span data-stu-id="28376-313">\<Scope>:</span></span>
    * <span data-ttu-id="28376-314">`-Name` 指示缓解应应用于特定应用。</span><span class="sxs-lookup"><span data-stu-id="28376-314">`-Name` to indicate the mitigations should be applied to a specific app.</span></span> <span data-ttu-id="28376-315">在此标志后指定应用的可执行文件。</span><span class="sxs-lookup"><span data-stu-id="28376-315">Specify the app's executable after this flag.</span></span>
    * <span data-ttu-id="28376-316">`-System` 指示应在系统级别应用缓解</span><span class="sxs-lookup"><span data-stu-id="28376-316">`-System` to indicate the mitigation should be applied at the system level</span></span>
- <span data-ttu-id="28376-317">\<Action>:</span><span class="sxs-lookup"><span data-stu-id="28376-317">\<Action>:</span></span>
    * <span data-ttu-id="28376-318">`-Enable` 启用缓解</span><span class="sxs-lookup"><span data-stu-id="28376-318">`-Enable` to enable the mitigation</span></span>
    * <span data-ttu-id="28376-319">`-Disable` 禁用缓解</span><span class="sxs-lookup"><span data-stu-id="28376-319">`-Disable` to disable the mitigation</span></span>
* <span data-ttu-id="28376-320">\<Mitigation>:</span><span class="sxs-lookup"><span data-stu-id="28376-320">\<Mitigation>:</span></span>
    * <span data-ttu-id="28376-321">缓解的 cmdlet，如下面的缓解 [cmdlet](#cmdlets-table) 表中定义，以及所有子选项 (空格) 。</span><span class="sxs-lookup"><span data-stu-id="28376-321">The mitigation's cmdlet as defined in the [mitigation cmdlets table](#cmdlets-table) below, along with any suboptions (surrounded with spaces).</span></span> <span data-ttu-id="28376-322">每个缓解用逗号分隔。</span><span class="sxs-lookup"><span data-stu-id="28376-322">Each mitigation is separated with a comma.</span></span>

<span data-ttu-id="28376-323">例如，若要使用 ATL thunk 仿真和 *文件夹 C：\Apps\LOB\tests* 中名为 *testing.exe* 的可执行文件启用数据执行保护 (DEP) 缓解，并阻止该可执行文件创建子进程，请使用以下命令：</span><span class="sxs-lookup"><span data-stu-id="28376-323">For example, to enable the Data Execution Prevention (DEP) mitigation with ATL thunk emulation and for an executable called *testing.exe* in the folder *C:\Apps\LOB\tests*, and to prevent that executable from creating child processes, you'd use the following command:</span></span>

```PowerShell
Set-ProcessMitigation -Name c:\apps\lob\tests\testing.exe -Enable DEP, EmulateAtlThunks, DisallowChildProcessCreation
```

> [!IMPORTANT]
> <span data-ttu-id="28376-324">使用逗号分隔每个缓解选项。</span><span class="sxs-lookup"><span data-stu-id="28376-324">Separate each mitigation option with commas.</span></span>

<span data-ttu-id="28376-325">如果要在系统级别应用 DEP，请使用以下命令：</span><span class="sxs-lookup"><span data-stu-id="28376-325">If you wanted to apply DEP at the system level, you'd use the following command:</span></span>

```PowerShell
Set-Processmitigation -System -Enable DEP
```

<span data-ttu-id="28376-326">若要禁用缓解，你可以将 `-Enable` 替换为 `-Disable` 。</span><span class="sxs-lookup"><span data-stu-id="28376-326">To disable mitigations, you can replace `-Enable` with `-Disable`.</span></span> <span data-ttu-id="28376-327">但是，对于应用级别的缓解，这将强制仅为该应用禁用缓解。</span><span class="sxs-lookup"><span data-stu-id="28376-327">However, for app-level mitigations, this will force the mitigation to be disabled only for that app.</span></span>

<span data-ttu-id="28376-328">如果需要将缓解恢复为系统默认值，还需要包括 `-Remove` cmdlet，如以下示例所示：</span><span class="sxs-lookup"><span data-stu-id="28376-328">If you need to restore the mitigation back to the system default, you need to include the `-Remove` cmdlet as well, as in the following example:</span></span>

```PowerShell
Set-Processmitigation -Name test.exe -Remove -Disable DEP
```

<span data-ttu-id="28376-329">还可以将某些缓解设置为审核模式。</span><span class="sxs-lookup"><span data-stu-id="28376-329">You can also set some mitigations to audit mode.</span></span> <span data-ttu-id="28376-330">请使用以下缓解 cmdlet 表中指定的审核模式 cmdlet，而不是将 PowerShell [cmdlet 用于](#cmdlets-table)缓解。</span><span class="sxs-lookup"><span data-stu-id="28376-330">Instead of using the PowerShell cmdlet for the mitigation, use the **Audit mode** cmdlet as specified in the [mitigation cmdlets table](#cmdlets-table) below.</span></span>

<span data-ttu-id="28376-331">例如，若要在审核模式下为 (使用的) 启用任意代码防护testing.exe，请使用以下命令： </span><span class="sxs-lookup"><span data-stu-id="28376-331">For example, to enable Arbitrary Code Guard (ACG) in audit mode for the *testing.exe* used previously, you'd use the following command:</span></span>

```PowerShell
Set-ProcessMitigation -Name c:\apps\lob\tests\testing.exe -Enable AuditDynamicCode
```

<span data-ttu-id="28376-332">可以使用相同命令禁用审核模式，但将 替换为 `-Enable` `-Disable` 。</span><span class="sxs-lookup"><span data-stu-id="28376-332">You can disable audit mode by using the same command but replacing `-Enable` with `-Disable`.</span></span>

### <a name="powershell-reference-table"></a><span data-ttu-id="28376-333">PowerShell 参考表</span><span class="sxs-lookup"><span data-stu-id="28376-333">PowerShell reference table</span></span>

<span data-ttu-id="28376-334">下表列出了可用于配置 (缓解的 PowerShell cmdlet) 关联的审核模式 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="28376-334">This table lists the PowerShell cmdlets (and associated audit mode cmdlet) that can be used to configure each mitigation.</span></span>

<a id="cmdlets-table"></a>

| <span data-ttu-id="28376-335">缓解措施</span><span class="sxs-lookup"><span data-stu-id="28376-335">Mitigation</span></span> | <span data-ttu-id="28376-336">适用于</span><span class="sxs-lookup"><span data-stu-id="28376-336">Applies to</span></span> | <span data-ttu-id="28376-337">PowerShell cmdlet</span><span class="sxs-lookup"><span data-stu-id="28376-337">PowerShell cmdlets</span></span> | <span data-ttu-id="28376-338">审核模式 cmdlet</span><span class="sxs-lookup"><span data-stu-id="28376-338">Audit mode cmdlet</span></span> |
| ---------- | ---------- | ------------------ | ----------------- |
| <span data-ttu-id="28376-339">控制流保护 (CFG) </span><span class="sxs-lookup"><span data-stu-id="28376-339">Control flow guard (CFG)</span></span> | <span data-ttu-id="28376-340">系统和应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-340">System and app-level</span></span> |   <span data-ttu-id="28376-341">CFG、StrictCFG、SuppressExports</span><span class="sxs-lookup"><span data-stu-id="28376-341">CFG,   StrictCFG,   SuppressExports</span></span>  | <span data-ttu-id="28376-342">审核不可用</span><span class="sxs-lookup"><span data-stu-id="28376-342">Audit not available</span></span> |
| <span data-ttu-id="28376-343">数据执行保护 (DEP) </span><span class="sxs-lookup"><span data-stu-id="28376-343">Data Execution Prevention (DEP)</span></span> | <span data-ttu-id="28376-344">系统和应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-344">System and app-level</span></span> |   <span data-ttu-id="28376-345">DEP、EmulateAtlThunks</span><span class="sxs-lookup"><span data-stu-id="28376-345">DEP,   EmulateAtlThunks</span></span>  | <span data-ttu-id="28376-346">审核不可用</span><span class="sxs-lookup"><span data-stu-id="28376-346">Audit not available</span></span> |
| <span data-ttu-id="28376-347">强制图像随机化 (强制 ASLR) </span><span class="sxs-lookup"><span data-stu-id="28376-347">Force randomization for images (Mandatory ASLR)</span></span> | <span data-ttu-id="28376-348">系统和应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-348">System and app-level</span></span> |   <span data-ttu-id="28376-349">ForceRelocateImages</span><span class="sxs-lookup"><span data-stu-id="28376-349">ForceRelocateImages</span></span>  | <span data-ttu-id="28376-350">审核不可用</span><span class="sxs-lookup"><span data-stu-id="28376-350">Audit not available</span></span> |
| <span data-ttu-id="28376-351">从下向上 ASLR (随机分配) </span><span class="sxs-lookup"><span data-stu-id="28376-351">Randomize memory allocations (Bottom-Up ASLR)</span></span> | <span data-ttu-id="28376-352">系统和应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-352">System and app-level</span></span> |   <span data-ttu-id="28376-353">BottomUp、HighEntropy</span><span class="sxs-lookup"><span data-stu-id="28376-353">BottomUp,   HighEntropy</span></span>  | <span data-ttu-id="28376-354">审核不可用</span><span class="sxs-lookup"><span data-stu-id="28376-354">Audit not available</span></span> |
| <span data-ttu-id="28376-355">验证 SEHOP (异常) </span><span class="sxs-lookup"><span data-stu-id="28376-355">Validate exception chains (SEHOP)</span></span> | <span data-ttu-id="28376-356">系统和应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-356">System and app-level</span></span> |   <span data-ttu-id="28376-357">SEHOP、SEHOPTelemetry</span><span class="sxs-lookup"><span data-stu-id="28376-357">SEHOP,   SEHOPTelemetry</span></span>  | <span data-ttu-id="28376-358">审核不可用</span><span class="sxs-lookup"><span data-stu-id="28376-358">Audit not available</span></span> |
| <span data-ttu-id="28376-359">验证堆完整性</span><span class="sxs-lookup"><span data-stu-id="28376-359">Validate heap integrity</span></span> | <span data-ttu-id="28376-360">系统和应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-360">System and app-level</span></span> |   <span data-ttu-id="28376-361">TerminateOnError</span><span class="sxs-lookup"><span data-stu-id="28376-361">TerminateOnError</span></span>  | <span data-ttu-id="28376-362">审核不可用</span><span class="sxs-lookup"><span data-stu-id="28376-362">Audit not available</span></span> |
| <span data-ttu-id="28376-363">ACG (任意代码) </span><span class="sxs-lookup"><span data-stu-id="28376-363">Arbitrary code guard (ACG)</span></span> | <span data-ttu-id="28376-364">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-364">App-level only</span></span> |   <span data-ttu-id="28376-365">DynamicCode</span><span class="sxs-lookup"><span data-stu-id="28376-365">DynamicCode</span></span>  |   <span data-ttu-id="28376-366">AuditDynamicCode</span><span class="sxs-lookup"><span data-stu-id="28376-366">AuditDynamicCode</span></span> |
| <span data-ttu-id="28376-367">阻止低完整性图像</span><span class="sxs-lookup"><span data-stu-id="28376-367">Block low integrity images</span></span> | <span data-ttu-id="28376-368">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-368">App-level only</span></span> |   <span data-ttu-id="28376-369">BlockLowLabel</span><span class="sxs-lookup"><span data-stu-id="28376-369">BlockLowLabel</span></span>  |   <span data-ttu-id="28376-370">AuditImageLoad</span><span class="sxs-lookup"><span data-stu-id="28376-370">AuditImageLoad</span></span> |
| <span data-ttu-id="28376-371">阻止远程图像</span><span class="sxs-lookup"><span data-stu-id="28376-371">Block remote images</span></span> | <span data-ttu-id="28376-372">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-372">App-level only</span></span> |   <span data-ttu-id="28376-373">BlockRemoteImages</span><span class="sxs-lookup"><span data-stu-id="28376-373">BlockRemoteImages</span></span>  | <span data-ttu-id="28376-374">审核不可用</span><span class="sxs-lookup"><span data-stu-id="28376-374">Audit not available</span></span> |
| <span data-ttu-id="28376-375">阻止不受信任的字体</span><span class="sxs-lookup"><span data-stu-id="28376-375">Block untrusted fonts</span></span> | <span data-ttu-id="28376-376">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-376">App-level only</span></span> |   <span data-ttu-id="28376-377">DisableNonSystemFonts</span><span class="sxs-lookup"><span data-stu-id="28376-377">DisableNonSystemFonts</span></span>  |   <span data-ttu-id="28376-378">AuditFont、FontAuditOnly</span><span class="sxs-lookup"><span data-stu-id="28376-378">AuditFont,   FontAuditOnly</span></span> |
| <span data-ttu-id="28376-379">代码完整性防护</span><span class="sxs-lookup"><span data-stu-id="28376-379">Code integrity guard</span></span> | <span data-ttu-id="28376-380">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-380">App-level only</span></span> |   <span data-ttu-id="28376-381">BlockNonMicrosoftSigned、AllowStoreSigned</span><span class="sxs-lookup"><span data-stu-id="28376-381">BlockNonMicrosoftSigned,   AllowStoreSigned</span></span>  |   <span data-ttu-id="28376-382">AuditMicrosoftSigned、AuditStoreSigned</span><span class="sxs-lookup"><span data-stu-id="28376-382">AuditMicrosoftSigned,   AuditStoreSigned</span></span> |
| <span data-ttu-id="28376-383">禁用扩展点</span><span class="sxs-lookup"><span data-stu-id="28376-383">Disable extension points</span></span> | <span data-ttu-id="28376-384">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-384">App-level only</span></span> |   <span data-ttu-id="28376-385">ExtensionPoint</span><span class="sxs-lookup"><span data-stu-id="28376-385">ExtensionPoint</span></span>  | <span data-ttu-id="28376-386">审核不可用</span><span class="sxs-lookup"><span data-stu-id="28376-386">Audit not available</span></span> |
| <span data-ttu-id="28376-387">禁用 Win32k 系统调用</span><span class="sxs-lookup"><span data-stu-id="28376-387">Disable Win32k system calls</span></span> | <span data-ttu-id="28376-388">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-388">App-level only</span></span> |   <span data-ttu-id="28376-389">DisableWin32kSystemCalls</span><span class="sxs-lookup"><span data-stu-id="28376-389">DisableWin32kSystemCalls</span></span>  |   <span data-ttu-id="28376-390">AuditSystemCall</span><span class="sxs-lookup"><span data-stu-id="28376-390">AuditSystemCall</span></span> |
| <span data-ttu-id="28376-391">不允许子进程</span><span class="sxs-lookup"><span data-stu-id="28376-391">Do not allow child processes</span></span> | <span data-ttu-id="28376-392">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-392">App-level only</span></span> |   <span data-ttu-id="28376-393">DisallowChildProcessCreation</span><span class="sxs-lookup"><span data-stu-id="28376-393">DisallowChildProcessCreation</span></span>  |   <span data-ttu-id="28376-394">AuditChildProcess</span><span class="sxs-lookup"><span data-stu-id="28376-394">AuditChildProcess</span></span> |
| <span data-ttu-id="28376-395">导出 EAF (地址) </span><span class="sxs-lookup"><span data-stu-id="28376-395">Export address filtering (EAF)</span></span> | <span data-ttu-id="28376-396">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-396">App-level only</span></span> |   <span data-ttu-id="28376-397">EnableExportAddressFilterPlus、EnableExportAddressFilter <a href="#r1" id="t1"> \[ 1 \] </a></span><span class="sxs-lookup"><span data-stu-id="28376-397">EnableExportAddressFilterPlus,   EnableExportAddressFilter  <a href="#r1" id="t1">\[1\]</a></span></span> | <span data-ttu-id="28376-398">审核不可用<a href="#r2" id="t2"> \[ 2 \] </a></span><span class="sxs-lookup"><span data-stu-id="28376-398">Audit not available<a href="#r2" id="t2">\[2\]</a></span></span> |
| <span data-ttu-id="28376-399">在 IAF (导入) </span><span class="sxs-lookup"><span data-stu-id="28376-399">Import address filtering (IAF)</span></span> | <span data-ttu-id="28376-400">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-400">App-level only</span></span> |   <span data-ttu-id="28376-401">EnableImportAddressFilter</span><span class="sxs-lookup"><span data-stu-id="28376-401">EnableImportAddressFilter</span></span>  | <span data-ttu-id="28376-402">审核不可用<a href="#r2" id="t2"> \[ 2 \] </a></span><span class="sxs-lookup"><span data-stu-id="28376-402">Audit not available<a href="#r2" id="t2">\[2\]</a></span></span> |
| <span data-ttu-id="28376-403">模拟 SimExec (执行) </span><span class="sxs-lookup"><span data-stu-id="28376-403">Simulate execution (SimExec)</span></span> | <span data-ttu-id="28376-404">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-404">App-level only</span></span> |   <span data-ttu-id="28376-405">EnableRopSimExec</span><span class="sxs-lookup"><span data-stu-id="28376-405">EnableRopSimExec</span></span>  | <span data-ttu-id="28376-406">审核不可用<a href="#r2" id="t2"> \[ 2 \] </a></span><span class="sxs-lookup"><span data-stu-id="28376-406">Audit not available<a href="#r2" id="t2">\[2\]</a></span></span> |
| <span data-ttu-id="28376-407">验证 CallerCheck (API) </span><span class="sxs-lookup"><span data-stu-id="28376-407">Validate API invocation (CallerCheck)</span></span> | <span data-ttu-id="28376-408">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-408">App-level only</span></span> |   <span data-ttu-id="28376-409">EnableRopCallerCheck</span><span class="sxs-lookup"><span data-stu-id="28376-409">EnableRopCallerCheck</span></span>  | <span data-ttu-id="28376-410">审核不可用<a href="#r2" id="t2"> \[ 2 \] </a></span><span class="sxs-lookup"><span data-stu-id="28376-410">Audit not available<a href="#r2" id="t2">\[2\]</a></span></span> |
| <span data-ttu-id="28376-411">验证句柄使用情况</span><span class="sxs-lookup"><span data-stu-id="28376-411">Validate handle usage</span></span> | <span data-ttu-id="28376-412">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-412">App-level only</span></span> |   <span data-ttu-id="28376-413">StrictHandle</span><span class="sxs-lookup"><span data-stu-id="28376-413">StrictHandle</span></span>  | <span data-ttu-id="28376-414">审核不可用</span><span class="sxs-lookup"><span data-stu-id="28376-414">Audit not available</span></span> |
| <span data-ttu-id="28376-415">验证图像依赖关系完整性</span><span class="sxs-lookup"><span data-stu-id="28376-415">Validate image dependency integrity</span></span> | <span data-ttu-id="28376-416">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-416">App-level only</span></span> |   <span data-ttu-id="28376-417">EnforceModuleDepencySigning</span><span class="sxs-lookup"><span data-stu-id="28376-417">EnforceModuleDepencySigning</span></span>  | <span data-ttu-id="28376-418">审核不可用</span><span class="sxs-lookup"><span data-stu-id="28376-418">Audit not available</span></span> |
| <span data-ttu-id="28376-419">验证 StackPivot (堆栈) </span><span class="sxs-lookup"><span data-stu-id="28376-419">Validate stack integrity (StackPivot)</span></span> | <span data-ttu-id="28376-420">仅应用级别</span><span class="sxs-lookup"><span data-stu-id="28376-420">App-level only</span></span> |   <span data-ttu-id="28376-421">EnableRopStackPivot</span><span class="sxs-lookup"><span data-stu-id="28376-421">EnableRopStackPivot</span></span>  | <span data-ttu-id="28376-422">审核不可用<a href="#r2" id="t2"> \[ 2 \] </a></span><span class="sxs-lookup"><span data-stu-id="28376-422">Audit not available<a href="#r2" id="t2">\[2\]</a></span></span> |

<span data-ttu-id="28376-423"><a href="#t1" id="r1"> \[ 1： \] </a>使用以下格式为进程启用 dll 的 EAF 模块：</span><span class="sxs-lookup"><span data-stu-id="28376-423"><a href="#t1" id="r1">\[1\]</a>: Use the following format to enable EAF modules for dlls for a process:</span></span>

```PowerShell
Set-ProcessMitigation -Name processName.exe -Enable EnableExportAddressFilterPlus -EAFModules dllName1.dll,dllName2.dll
```

<span data-ttu-id="28376-424"><a href="#t2" id="r2"> \[ 2： \] </a>无法通过 PowerShell cmdlet 审核此缓解。</span><span class="sxs-lookup"><span data-stu-id="28376-424"><a href="#t2" id="r2">\[2\]</a>: Audit for this mitigation is not available via PowerShell cmdlets.</span></span>

## <a name="customize-the-notification"></a><span data-ttu-id="28376-425">自定义通知</span><span class="sxs-lookup"><span data-stu-id="28376-425">Customize the notification</span></span>

<span data-ttu-id="28376-426">有关在触发规则并阻止应用或文件时自定义通知的信息，请参阅 [Windows 安全中心](https://docs.microsoft.com/windows/security/threat-protection/windows-defender-security-center/windows-defender-security-center#customize-notifications-from-the-windows-defender-security-center)。</span><span class="sxs-lookup"><span data-stu-id="28376-426">For more information about customizing the notification when a rule is triggered and blocks an app or file, see [Windows Security](https://docs.microsoft.com/windows/security/threat-protection/windows-defender-security-center/windows-defender-security-center#customize-notifications-from-the-windows-defender-security-center).</span></span>

## <a name="see-also"></a><span data-ttu-id="28376-427">另请参阅：</span><span class="sxs-lookup"><span data-stu-id="28376-427">See also:</span></span>

* [<span data-ttu-id="28376-428">保护设备免遭攻击</span><span class="sxs-lookup"><span data-stu-id="28376-428">Protect devices from exploits</span></span>](exploit-protection.md)
* [<span data-ttu-id="28376-429">评估 Exploit Protection</span><span class="sxs-lookup"><span data-stu-id="28376-429">Evaluate exploit protection</span></span>](evaluate-exploit-protection.md)
* [<span data-ttu-id="28376-430">启用漏洞保护</span><span class="sxs-lookup"><span data-stu-id="28376-430">Enable exploit protection</span></span>](enable-exploit-protection.md)
* [<span data-ttu-id="28376-431">导入、导出和部署 Exploit Protection 配置</span><span class="sxs-lookup"><span data-stu-id="28376-431">Import, export, and deploy exploit protection configurations</span></span>](import-export-exploit-protection-emet-xml.md)
